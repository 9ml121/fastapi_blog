# Markdown ç¼–è¾‘å™¨è®¾è®¡æ–‡æ¡£

> **æ–‡æ¡£ç›®çš„**ï¼šå®šä¹‰å¯å¤ç”¨çš„ Markdown ç¼–è¾‘å™¨æ¨¡å—çš„è®¾è®¡æ–¹æ¡ˆã€æ ·å¼è§„èŒƒå’ŒæŠ€æœ¯å®ç°  
> **ç»´æŠ¤äºº**ï¼šé¡¹ç›®å›¢é˜Ÿ  
> **æ›´æ–°æ—¥æœŸ**ï¼š2025-11-18  
> **ç‰ˆæœ¬**ï¼šv1.0  
> **è®¾è®¡ç†å¿µ**ï¼šç”Ÿäº§çº§é«˜å¤ç”¨æ¨¡å— - ä¸€æ¬¡è®¾è®¡ï¼Œå¤šé¡¹ç›®ä½¿ç”¨

---

## ğŸ“‹ ç›®å½•

1. [äº§å“å®šä½](#äº§å“å®šä½)
2. [æ ·å¼è®¾è®¡](#æ ·å¼è®¾è®¡)
3. [æŠ€æœ¯æ¶æ„](#æŠ€æœ¯æ¶æ„)
4. [æ¨¡å—ç»“æ„](#æ¨¡å—ç»“æ„)
5. [API è®¾è®¡](#api-è®¾è®¡)
6. [ç±»å‹ç³»ç»Ÿ](#ç±»å‹ç³»ç»Ÿ)
7. [ä½¿ç”¨ç¤ºä¾‹](#ä½¿ç”¨ç¤ºä¾‹)
8. [å®ç°è·¯çº¿](#å®ç°è·¯çº¿)

---

## ğŸ¯ äº§å“å®šä½

### ä¸ºä»€ä¹ˆæ˜¯è¿™ä¸ªç¼–è¾‘å™¨ï¼Ÿ

ä¸€ä¸ª**ç”Ÿäº§çº§åˆ«ã€é«˜åº¦å¯å¤ç”¨**çš„Markdownç¼–è¾‘å™¨æ¨¡å—ï¼Œè®¾è®¡åŸåˆ™ï¼š

- âœ… **å¼€ç®±å³ç”¨** - é›¶é…ç½®å¯åŠ¨ï¼Œæ»¡è¶³80%çš„ä½¿ç”¨åœºæ™¯
- âœ… **çµæ´»å¯å®šåˆ¶** - é…ç½®é©±åŠ¨ï¼Œæ”¯æŒæ·±åº¦å®šåˆ¶è€Œä¸ä¿®æ”¹æ ¸å¿ƒä»£ç 
- âœ… **è·¨æ¡†æ¶æ”¯æŒ** - æ ¸å¿ƒé€»è¾‘ä¸UIæ¡†æ¶è§£è€¦ï¼Œå¯ç§»æ¤åˆ° React / Angular / Vanilla JS
- âœ… **é«˜åº¦å¯å¤ç”¨** - ç”¨äºåšå®¢ç¼–è¾‘ã€è¯„è®ºã€ç¬”è®°ã€æ–‡æ¡£ç­‰å¤šç§åœºæ™¯

### è®¾è®¡ç›®æ ‡

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ç›®æ ‡ç”¨æˆ·å’Œä½¿ç”¨åœºæ™¯                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                 â”‚
â”‚ ğŸ“ åœºæ™¯1ï¼šæ–‡ç« ç¼–è¾‘ï¼ˆæœ¬é¡¹ç›®ä¸»åœºæ™¯ï¼‰              â”‚
â”‚    - ç”¨æˆ·éœ€è¦å‘å¸ƒå®Œæ•´çš„Markdownæ–‡ç«             â”‚
â”‚    - éœ€è¦å®æ—¶é¢„è§ˆå’Œæ ¼å¼åŒ–å·¥å…·                  â”‚
â”‚    - è‡ªåŠ¨ä¿å­˜è‰ç¨¿                              â”‚
â”‚                                                 â”‚
â”‚ ğŸ’¬ åœºæ™¯2ï¼šè¯„è®ºç¼–è¾‘ï¼ˆæ”¯æŒå¯Œæ–‡æœ¬ï¼‰               â”‚
â”‚    - ç”¨æˆ·å›å¤è¯„è®ºï¼Œéœ€è¦éƒ¨åˆ†Markdownæ ¼å¼        â”‚
â”‚    - ç®€åŒ–çš„å·¥å…·æ ï¼Œå¿«é€Ÿè¾“å…¥                     â”‚
â”‚                                                 â”‚
â”‚ ğŸ““ åœºæ™¯3ï¼šç¬”è®°ç¼–è¾‘ï¼ˆå†…éƒ¨é¡¹ç›®ï¼‰                 â”‚
â”‚    - å¿«é€Ÿè®°ç¬”è®°ï¼Œæ”¯æŒåµŒå…¥ä»£ç å—å’Œå›¾ç‰‡         â”‚
â”‚    - æŠ˜å åŠŸèƒ½ï¼Œé€‚åˆé•¿æ–‡æ¡£                     â”‚
â”‚                                                 â”‚
â”‚ ğŸ”§ åœºæ™¯4ï¼šè‡ªå®šä¹‰æ‰©å±•ï¼ˆå¼€å‘è€…ï¼‰                 â”‚
â”‚    - æ’ä»¶ç³»ç»Ÿæ”¯æŒè‡ªå®šä¹‰è¯­æ³•ï¼ˆ@mentionã€emojiï¼‰â”‚
â”‚    - å®Œæ•´çš„ Hooks æœºåˆ¶                         â”‚
â”‚                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æ ¸å¿ƒä»·å€¼

| ç»´åº¦ | ä»·å€¼ |
|------|------|
| **å¼€å‘æ•ˆç‡** | å‡å°‘50%çš„ç¼–è¾‘å™¨ç¼–ç æ—¶é—´ |
| **ä»£ç å¤ç”¨** | ä¸€æ¬¡å¼€å‘ï¼Œå¤šé¡¹ç›®æ— ç¼é›†æˆ |
| **å¯ç»´æŠ¤æ€§** | é›†ä¸­ç»´æŠ¤ç¼–è¾‘å™¨é€»è¾‘ï¼Œé¡¹ç›®èšç„¦ä¸šåŠ¡ |
| **ç”¨æˆ·ä½“éªŒ** | Mediumçº§åˆ«çš„ç¼–è¾‘ä½“éªŒ |
| **æ€§èƒ½** | ä¼˜åŒ–çš„æ¸²æŸ“ï¼Œæ”¯æŒå¤§å‹æ–‡æ¡£ |

---

## ğŸ¨ æ ·å¼è®¾è®¡

### 1\. ç¼–è¾‘å™¨æ•´ä½“å¸ƒå±€ï¼ˆMediumé£æ ¼æ‰€è§å³æ‰€å¾—ï¼‰

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Header                                              â”‚
â”‚  (è‡ªåŠ¨ä¿å­˜çŠ¶æ€ | å‘å¸ƒ | æ›´å¤šé€‰é¡¹)                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                      â”‚
â”‚  æ ‡é¢˜è¾“å…¥æ¡†                                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ æˆ‘çš„æ–‡ç« æ ‡é¢˜ (placeholder)                      â”‚ â”‚
â”‚  â”‚ (contenteditable + font-size: 32px bold)      â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                      â”‚
â”‚  æ­£æ–‡ç¼–è¾‘åŒºï¼ˆæ‰€è§å³æ‰€å¾—ï¼‰                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ ## è¿™æ˜¯äºŒçº§æ ‡é¢˜                                 â”‚ â”‚
â”‚  â”‚                                                â”‚ â”‚
â”‚  â”‚ è¿™æ˜¯ä¸€æ®µæ­£æ–‡ã€‚**ç²—ä½“æ–‡æœ¬**ã€*æ–œä½“æ–‡æœ¬*          â”‚ â”‚
â”‚  â”‚ å’Œ [é“¾æ¥](url)                                â”‚ â”‚
â”‚  â”‚                                                â”‚ â”‚
â”‚  â”‚ - åˆ—è¡¨é¡¹ 1                                     â”‚ â”‚
â”‚  â”‚ - åˆ—è¡¨é¡¹ 2                                     â”‚ â”‚
â”‚  â”‚                                                â”‚ â”‚
â”‚  â”‚ ```javascript                                 â”‚ â”‚
â”‚  â”‚ const code = 'hello world';                   â”‚ â”‚
â”‚  â”‚ ```                                           â”‚ â”‚
â”‚  â”‚ (contenteditable div)                         â”‚ â”‚
â”‚  â”‚                                                â”‚ â”‚
â”‚  â”‚  â”Œâ”€ æµ®åŠ¨å·¥å…·æ  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚ â”‚
â”‚  â”‚  â”‚ [B] [I] [Link] [Code] ... â”‚ (é€‰ä¸­æ—¶å‡ºç°) â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                      â”‚
â”‚  Footer                                              â”‚
â”‚  (å­—æ•°ç»Ÿè®¡ | ä¿å­˜çŠ¶æ€ | é¢„è®¡é˜…è¯»æ—¶é—´)                â”‚
â”‚                                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**å…³é”®ç‰¹å¾ï¼ˆçœŸæ­£çš„æ‰€è§å³æ‰€å¾—ï¼‰**ï¼š
- âœ… å•ä¸€çš„ç¼–è¾‘åŒºï¼Œæ²¡æœ‰åˆ†å±é¢„è§ˆ
- âœ… ç”¨æˆ·è¾“å…¥ Markdown è¯­æ³•ï¼Œå®æ—¶çœ‹åˆ°æ ¼å¼åŒ–æ•ˆæœ
- âœ… `contenteditable` div åŒæ—¶æ˜¯ç¼–è¾‘ç•Œé¢å’Œé¢„è§ˆç•Œé¢
- âœ… æµ®åŠ¨å·¥å…·æ ä»…åœ¨ç”¨æˆ·é€‰ä¸­æ–‡æœ¬æ—¶å‡ºç°
- âœ… è§†è§‰ä½“éªŒå°±åƒåœ¨å†™æ–‡ç« ï¼Œè€Œä¸æ˜¯å†™ä»£ç 

### 2. è‰²å½©è§„èŒƒ

åŸºäºé¡¹ç›®è®¾è®¡ç³»ç»Ÿçš„ç¼–è¾‘å™¨è‰²å½©ï¼ˆ`phase1_design_system.md`ï¼‰

#### ç¼–è¾‘åŒºåŸŸè‰²å½©
```
èƒŒæ™¯ï¼š#FFFFFF (çº¯ç™½)
æ–‡æœ¬ï¼š#1F2937 (ç°-900)
è¾¹æ¡†ï¼š#E5E7EB (ç°-200)
ç„¦ç‚¹ç¯ï¼š#0EA5E9 (Primary è“)
```

#### å·¥å…·æ è‰²å½©
```
èƒŒæ™¯ï¼š#FFFFFF (çº¯ç™½) + shadow-md
æŒ‰é’®é»˜è®¤ï¼š#9CA3AF (ç°-400) text
æŒ‰é’®æ¿€æ´»ï¼š#0EA5E9 (Primary è“)
æŒ‰é’®æ‚¬åœï¼š#F3F4F6 (ç°-100) bg
```

#### Markdown æ ¼å¼åŒ–è‰²å½©ï¼ˆåœ¨ç¼–è¾‘åŒºå†…æ˜¾ç¤ºï¼‰
```
ä»£ç å—èƒŒæ™¯ï¼š#1F2937 (ç°-900)
ä»£ç å—æ–‡æœ¬ï¼š#FFFFFF (çº¯ç™½)
ä»£ç å—è¾¹æ¡†ï¼š#374151 (ç°-700)
è¡Œå·/è¯­æ³•é«˜äº®ï¼š#10B981 (ç»¿è‰²)

å¼•ç”¨å—ï¼š
  - å·¦è¾¹æ¡†ï¼š#0EA5E9 (Primary è“)
  - èƒŒæ™¯ï¼š#EFF6FF (è“-50)
  - æ–‡æœ¬ï¼š#1e40af (è“-900)

åˆ—è¡¨æ ‡è®°ï¼š#9CA3AF (ç°-400)
é“¾æ¥æ–‡æœ¬ï¼š#0EA5E9 (Primary è“)
```

### 3. æ’ç‰ˆè§„èŒƒ

åŸºäºé¡¹ç›®è®¾è®¡ç³»ç»Ÿçš„ç¼–è¾‘å™¨æ’ç‰ˆï¼ˆ`phase1_design_system.md`ï¼‰

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ç¼–è¾‘åŒºæ’ç‰ˆ                                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ æ ‡é¢˜è¾“å…¥                                          â”‚
â”‚   - å­—ä½“å¤§å°ï¼š32px (text-4xl)                    â”‚
â”‚   - å­—é‡ï¼šbold (font-bold)                       â”‚
â”‚   - è¡Œé«˜ï¼š1.2 (leading-tight)                    â”‚
â”‚   - ä¸‹è¾¹è·ï¼š16px (mb-4)                         â”‚
â”‚   - å ä½ç¬¦ï¼šç°-400 text                         â”‚
â”‚                                                 â”‚
â”‚ æ­£æ–‡è¾“å…¥                                          â”‚
â”‚   - å­—ä½“å¤§å°ï¼š16px (text-base)                  â”‚
â”‚   - å­—é‡ï¼šnormal                                â”‚
â”‚   - è¡Œé«˜ï¼š1.75 (leading-relaxed)               â”‚
â”‚   - æœ€å°é«˜åº¦ï¼š600px (min-h-[600px])             â”‚
â”‚   - å ä½ç¬¦ï¼šç°-400 text                         â”‚
â”‚                                                 â”‚
â”‚ Markdown æ ¼å¼æ˜¾ç¤ºï¼ˆåœ¨ç¼–è¾‘åŒºå†…ï¼‰                  â”‚
â”‚   - H1ï¼š32px bold / 1.2è¡Œé«˜                     â”‚
â”‚   - H2ï¼š24px semibold / 1.3è¡Œé«˜                â”‚
â”‚   - H3ï¼š18px semibold / 1.3è¡Œé«˜                â”‚
â”‚   - æ­£æ–‡ï¼š16px normal / 1.75è¡Œé«˜               â”‚
â”‚   - ä»£ç è¡Œå†…ï¼š14px font-mono, bg-gray-100      â”‚
â”‚   - ä»£ç å—ï¼š14px font-mono, bg-gray-900        â”‚
â”‚                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 4\. é—´è·è§„èŒƒ

```
ç¼–è¾‘å™¨å®¹å™¨ï¼šmax-width: 800px / margin: 0 auto
ï¼ˆMediumçš„æœ€ä¼˜é˜…è¯»å®½åº¦ï¼‰

æ ‡é¢˜ç¼–è¾‘åŒºï¼š
  - padding: 24px (lg)
  - border-bottom: 1px #E5E7EB
  - margin-bottom: 16px (md)

æ­£æ–‡ç¼–è¾‘åŒºï¼š
  - padding: 24px (lg)
  - min-height: 600px
  - line-height: 1.75 (èˆ’é€‚çš„è¡Œé—´è·)

æµ®åŠ¨å·¥å…·æ ï¼š
  - å‡ºç°åœ¨é€‰ä¸­æ–‡æœ¬ä¸Šæ–¹ 8px (xs)
  - padding: 8px (xs)
  - gap: 4px (iconä¹‹é—´)

å“åº”å¼æ–­ç‚¹ï¼š
  - lg (â‰¥1024px): ç¼–è¾‘å™¨å®½åº¦ 800px + ä¾§è¾¹æ 
  - md (â‰¥768px): ç¼–è¾‘å™¨å®½åº¦ 100% - 1rem padding
  - sm (<768px): ç¼–è¾‘å™¨å®½åº¦ 100% - 0.5rem paddingï¼Œå·¥å…·æ å¯æ»šåŠ¨
```

### 5. äº¤äº’çŠ¶æ€

#### ç¼–è¾‘åŒºäº¤äº’
```
é»˜è®¤ï¼š
  - èƒŒæ™¯ï¼šç™½è‰²
  - è¾¹æ¡†ï¼šç°-200
  - æ–‡æœ¬ï¼šç°-900

èšç„¦ï¼š
  - èƒŒæ™¯ï¼šç™½è‰²
  - è¾¹æ¡†ï¼šPrimary è“ + ç¯
  - æ–‡æœ¬ï¼šç°-900
  - é˜´å½±ï¼šring-2 ring-blue-100

ç¦ç”¨ï¼š
  - èƒŒæ™¯ï¼šç°-50
  - æ–‡æœ¬ï¼šç°-400
  - å…‰æ ‡ï¼šnot-allowed
```

#### å·¥å…·æ æŒ‰é’®
```
é»˜è®¤ï¼š
  - èƒŒæ™¯ï¼šé€æ˜
  - æ–‡æœ¬ï¼šç°-500
  - å…‰æ ‡ï¼špointer

æ‚¬åœï¼š
  - èƒŒæ™¯ï¼šç°-100
  - æ–‡æœ¬ï¼šç°-700
  - è¿‡æ¸¡ï¼štransition-colors duration-200

æ¿€æ´»ï¼ˆå·²åº”ç”¨ï¼‰ï¼š
  - èƒŒæ™¯ï¼šblue-100
  - æ–‡æœ¬ï¼šPrimary è“
  - è¾¹æ¡†ï¼šPrimary è“

ç¦ç”¨ï¼š
  - æ–‡æœ¬ï¼šç°-300
  - å…‰æ ‡ï¼šnot-allowed
  - ä¸é€æ˜åº¦ï¼šopacity-50
```

### 6. åŠ¨ç”»è¿‡æ¸¡

```
å·¥å…·æ å‡ºç°/æ¶ˆå¤±ï¼š
  - duration: 150ms (fade-in/out)
  - easing: ease-out

æŒ‰é’®åé¦ˆï¼š
  - duration: 200ms
  - easing: ease-out

é¢„è§ˆåˆ·æ–°ï¼š
  - duration: 300ms (debounce)

æ ‡ç­¾é¡µåˆ‡æ¢ï¼š
  - duration: 200ms
  - easing: ease-out
```

---

## ğŸ—ï¸ æŠ€æœ¯æ¶æ„

### 1. æ¶æ„è®¾è®¡åŸç†

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚               Markdown ç¼–è¾‘å™¨æ¨¡å—æ¶æ„                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                      â”‚
â”‚  â”Œâ”€ Vue 3 ç»„ä»¶å±‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚                                                 â”‚ â”‚
â”‚  â”‚  MarkdownEditor.vue (ä¸»ç»„ä»¶)
  â”œâ”€ EditorHeader.vue (ä¿å­˜çŠ¶æ€ã€å·¥å…·é€‰é¡¹)
  â”œâ”€ EditorTitle.vue (æ ‡é¢˜è¾“å…¥)
  â”œâ”€ EditorContent.vue (æ­£æ–‡ç¼–è¾‘+WYSIWYG)
  â”œâ”€ EditorToolbar.vue (æµ®åŠ¨å·¥å…·æ )
  â””â”€ EditorFooter.vue (å­—æ•°ç»Ÿè®¡ã€æ—¶é—´).vue                           â”‚ â”‚
â”‚  â”‚                                                 â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                       â†“                              â”‚
â”‚  â”Œâ”€ Composable å±‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚                                                 â”‚ â”‚
â”‚  â”‚  useMarkdownEditor()   â† æ ¸å¿ƒç¼–è¾‘é€»è¾‘          â”‚ â”‚
â”‚  â”‚  useToolbar()          â† å·¥å…·æ çŠ¶æ€ç®¡ç†        â”‚ â”‚
â”‚  â”‚  useAutoSave()         â† è‡ªåŠ¨ä¿å­˜              â”‚ â”‚
â”‚  â”‚  useShortcuts()        â† å¿«æ·é”®å¤„ç†            â”‚ â”‚
â”‚  â”‚                                                 â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                       â†“                              â”‚
â”‚  â”Œâ”€ å·¥å…·å‡½æ•°å±‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚                                                 â”‚ â”‚
â”‚  â”‚  markdown-utils.ts                             â”‚ â”‚
â”‚  â”‚  â”œâ”€ parseMarkdown()                            â”‚ â”‚
â”‚  â”‚  â”œâ”€ renderHtml()                               â”‚ â”‚
â”‚  â”‚  â””â”€ sanitizeHtml()                             â”‚ â”‚
â”‚  â”‚                                                 â”‚ â”‚
â”‚  â”‚  selection-utils.ts                            â”‚ â”‚
â”‚  â”‚  â”œâ”€ getSelection()                             â”‚ â”‚
â”‚  â”‚  â”œâ”€ setSelection()                             â”‚ â”‚
â”‚  â”‚  â””â”€ wrapText()                                 â”‚ â”‚
â”‚  â”‚                                                 â”‚ â”‚
â”‚  â”‚  editor-helpers.ts                             â”‚ â”‚
â”‚  â”‚  â”œâ”€ insertHeading()                            â”‚ â”‚
â”‚  â”‚  â”œâ”€ insertLink()                               â”‚ â”‚
â”‚  â”‚  â””â”€ insertCodeBlock()                          â”‚ â”‚
â”‚  â”‚                                                 â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                       â†“                              â”‚
â”‚  â”Œâ”€ ç±»å‹å’Œé…ç½®å±‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚                                                 â”‚ â”‚
â”‚  â”‚  editor.types.ts  (TypeScript ç±»å‹å®šä¹‰)       â”‚ â”‚
â”‚  â”‚  editor.config.ts (é»˜è®¤é…ç½®)                  â”‚ â”‚
â”‚  â”‚                                                 â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                       â†“                              â”‚
â”‚  â”Œâ”€ å¤–éƒ¨ä¾èµ–å±‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚                                                 â”‚ â”‚
â”‚  â”‚  marked           - Markdown è§£æ             â”‚ â”‚
â”‚  â”‚  highlight.js     - ä»£ç é«˜äº® (å¯é€‰)           â”‚ â”‚
â”‚  â”‚                                                 â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2. åˆ†å±‚ä¼˜åŠ¿

| å±‚çº§ | ä¼˜åŠ¿ |
|------|------|
| **ç»„ä»¶å±‚** | Vue 3 ç‰¹å®šï¼ŒUI å®ç° |
| **Composableå±‚** | å¯å¤ç”¨é€»è¾‘ï¼Œä¸ UI æ¡†æ¶æ— å…³ |
| **å·¥å…·å‡½æ•°å±‚** | çº¯å‡½æ•°ï¼Œå¯åœ¨ä»»ä½•ç¯å¢ƒè¿è¡Œ |
| **ç±»å‹å’Œé…ç½®** | æ”¯æŒé…ç½®é©±åŠ¨çš„è¡Œä¸º |

**ç»“æœ**ï¼šæ ¸å¿ƒé€»è¾‘å¯ä»¥ç§»æ¤åˆ°ä»»ä½•æ¡†æ¶ï¼

### 3. æ•°æ®æµå‘

```
ç”¨æˆ·è¾“å…¥ (contenteditable div)
    â†“
å®æ—¶æ¸²æŸ“ Markdown æ ¼å¼ (æ‰€è§å³æ‰€å¾—)
    â†“
è·å–é€‰ä¸­æ–‡æœ¬ (getSelection - ç”¨äºå·¥å…·æ )
    â†“
å·¥å…·æ æ“ä½œï¼šåº”ç”¨æ ¼å¼ (wrapText / insertText)
    â†“
æ›´æ–° contenteditable å†…å®¹
    â†“
è§¦å‘ input äº‹ä»¶
    â†“
debounce 500ms (é˜²æ­¢é¢‘ç¹ä¿å­˜)
    â†“
è·å–å†…å®¹ (textContent + innerHTML)
    â†“
è‡ªåŠ¨ä¿å­˜ (localStorage / API)
    â†“
æ›´æ–°ç¼–è¾‘çŠ¶æ€ (å­—æ•°ã€ä¿å­˜æ—¶é—´)
    â†“
å‘å‡º change äº‹ä»¶
```

---

## ğŸ”§ Phase 1.2 è¾…åŠ©å‡½æ•°æ¶æ„è®¾è®¡

### æ•´ä½“è®¾è®¡æ€è·¯

Phase 1.2 çš„æ ¸å¿ƒæ˜¯**å®ç° 5 ä¸ªå…³é”®çš„ Composable**ï¼Œå°†ç¼–è¾‘å™¨çš„å¤æ‚é€»è¾‘åˆ†å±‚ç®¡ç†ã€‚è¿™éµå¾ªäº†**å•ä¸€èŒè´£åŸåˆ™**å’Œ**ä¾èµ–æ³¨å…¥æ¨¡å¼**ï¼Œä½¿ä»£ç é«˜åº¦å¯æµ‹è¯•å’Œå¯ç»´æŠ¤ã€‚

```
ç¼–è¾‘å™¨ç³»ç»Ÿä¾èµ–å…³ç³»ï¼ˆåˆ†å±‚ï¼‰ï¼š

      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
      â”‚  useMarkdownEditor()            â”‚  â† ç¬¬5å±‚ï¼ˆåè°ƒå±‚ï¼‰
      â”‚  ä¸» Composableï¼ˆå¯¹å¤–æ¥å£ï¼‰      â”‚
      â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
      â”‚                  â”‚              â”‚              â”‚
      â–¼                  â–¼              â–¼              â–¼
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚useHistory    â”‚useSelection   â”‚useMarkdown    â”‚useAutoSaveâ”‚ â† ç¬¬4å±‚ï¼ˆåŠŸèƒ½å±‚ï¼‰
  â”‚æ’¤é”€é‡åš  â”‚     é€‰ä¸­æ–‡æœ¬    â”‚    æ ¼å¼åŒ–           â”‚è‡ªåŠ¨ä¿å­˜    â”‚
  â”‚äº‹åŠ¡ç®¡ç†  â”‚     å…‰æ ‡æ“ä½œ    â”‚    Markdown        â”‚æ··åˆæ–¹æ¡ˆ    â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
      â”‚              â”‚              â”‚              â”‚
      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â–¼
      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
      â”‚  EditorState (æ ¸å¿ƒçŠ¶æ€)         â”‚  â† ç¬¬3å±‚ï¼ˆçŠ¶æ€å±‚ï¼‰
      â”‚  4å±‚çŠ¶æ€æ¶æ„                    â”‚
      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â–¼
      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
      â”‚  è¾…åŠ©å·¥å…·å‡½æ•°                   â”‚  â† ç¬¬2å±‚ï¼ˆå·¥å…·å±‚ï¼‰
      â”‚  - historyUtils.ts            â”‚
      â”‚  - markdownUtils.ts           â”‚
      â”‚  - selectionUtils.ts          â”‚
      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â–¼
      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
      â”‚  TypeScript ç±»å‹ç³»ç»Ÿ            â”‚  â† ç¬¬1å±‚ï¼ˆåŸºç¡€å±‚ï¼‰
      â”‚  - EditorState                â”‚
      â”‚  - EditTransaction            â”‚
      â”‚  - SelectionInfo              â”‚
      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 5 ä¸ª Composable çš„è¯¦ç»†èŒè´£

#### 1ï¸âƒ£ **useSelection** - æ–‡æœ¬é€‰ä¸­å¤„ç†ï¼ˆåŸºç¡€å±‚ï¼‰

**ç›®çš„**ï¼šç®¡ç†ç¼–è¾‘å™¨ä¸­çš„å…‰æ ‡ä½ç½®å’Œæ–‡æœ¬é€‰ä¸­çŠ¶æ€

**æ ¸å¿ƒèŒè´£**ï¼š
```typescript
export function useSelection(
  editorRef: Ref<HTMLDivElement | null>,
  state: EditorState
) {
  // è·å–å½“å‰é€‰ä¸­çš„æ–‡æœ¬èŒƒå›´ï¼ˆstart, end, selectedTextï¼‰
  const getSelection = (): SelectionInfo => { ... }
  
  // è®¾ç½®å…‰æ ‡ä½ç½®åˆ°æŒ‡å®šä½ç½®
  const setCursor = (position: number): void => { ... }
  
  // é€‰ä¸­æŒ‡å®šèŒƒå›´çš„æ–‡æœ¬
  const selectRange = (start: number, end: number): void => { ... }
  
  // åŒ…è£¹é€‰ä¸­æ–‡æœ¬ï¼ˆåŠ ç²—ã€æ–œä½“ç­‰ï¼‰
  const wrapSelection = (before: string, after: string): void => { ... }
  
  // åˆ¤æ–­å½“å‰æ˜¯å¦æœ‰æ–‡æœ¬è¢«é€‰ä¸­
  const hasSelection = (): boolean => { ... }
  
  // è·å–å…‰æ ‡æ‰€åœ¨è¡Œçš„å†…å®¹
  const getCurrentLine = (): string => { ... }
  
  return { getSelection, setCursor, selectRange, wrapSelection, hasSelection, getCurrentLine }
}
```

**å…³é”®å®ç°ç»†èŠ‚**ï¼š
- ä½¿ç”¨æµè§ˆå™¨ Selection APIï¼ˆgetSelection()ã€getRangeAt()ï¼‰
- å¤„ç†å…‰æ ‡ä½ç½®çš„å­—ç¬¦åç§»è®¡ç®—
- æ”¯æŒè·¨è¶Š DOM èŠ‚ç‚¹çš„é€‰ä¸­
- æ›´æ–° UI å±‚çš„ SelectionInfo çŠ¶æ€

**éš¾åº¦**ï¼šâ­â­ï¼ˆåŸºç¡€ï¼Œä½†éœ€è¦ç†è§£ DOM Selection APIï¼‰

---

#### 2ï¸âƒ£ **useHistory** - æ’¤é”€é‡åšï¼ˆæ ¸å¿ƒå¤æ‚ï¼‰

**ç›®çš„**ï¼šç®¡ç† EditTransaction æ ˆï¼Œæ”¯æŒæ’¤é”€å’Œé‡åšæ“ä½œ

**æ ¸å¿ƒèŒè´£**ï¼š
```typescript
export function useHistory(
  state: EditorState,
  config: EditorConfig
) {
  // æ·»åŠ ä¸€ä¸ªäº‹åŠ¡åˆ°å†å²æ ˆ
  const addTransaction = (tx: EditTransaction): void => { ... }
  
  // æ‰§è¡Œæ’¤é”€æ“ä½œï¼ˆå›åˆ°ä¸Šä¸€ä¸ªäº‹åŠ¡ï¼‰
  const undo = (): void => { ... }
  
  // æ‰§è¡Œé‡åšæ“ä½œï¼ˆå‰è¿›åˆ°ä¸‹ä¸€ä¸ªäº‹åŠ¡ï¼‰
  const redo = (): void => { ... }
  
  // æ£€æŸ¥æ˜¯å¦å¯ä»¥æ’¤é”€
  const canUndo = (): boolean => { ... }
  
  // æ£€æŸ¥æ˜¯å¦å¯ä»¥é‡åš
  const canRedo = (): boolean => { ... }
  
  // æ¸…ç©ºæ‰€æœ‰å†å²è®°å½•
  const clearHistory = (): void => { ... }
  
  // è·å–å†å²æ ˆä¿¡æ¯ï¼ˆè°ƒè¯•ç”¨ï¼‰
  const getHistoryInfo = () => ({
    totalTransactions: number,
    currentIndex: number,
    canUndo: boolean,
    canRedo: boolean,
  })
  
  return { addTransaction, undo, redo, canUndo, canRedo, clearHistory, getHistoryInfo }
}
```

**æ ¸å¿ƒç®—æ³•**ï¼ˆé‡ç‚¹ï¼ï¼‰ï¼š
```
æ’¤é”€é€»è¾‘ï¼š
  currentIndex = 2 (å¤„äº transaction[2] ä¹‹å)
  undo() â†’ currentIndex = 1
  â†’ æ¢å¤åˆ° transaction[1] ä¹‹åçš„çŠ¶æ€
  
é‡åšé€»è¾‘ï¼š
  currentIndex = 1
  redo() â†’ currentIndex = 2
  â†’ é‡æ–°åº”ç”¨ transaction[2]
  
æ‰§è¡Œæ–°æ“ä½œæ—¶ï¼š
  currentIndex = 1
  addTransaction(txNew) 
  â†’ åˆ é™¤ transactions[2...] (ä¹‹åçš„æ‰€æœ‰äº‹åŠ¡)
  â†’ æ·»åŠ æ–°äº‹åŠ¡åˆ°æœ«å°¾
  â†’ currentIndex = 2
```

**å…³é”®è®¾è®¡ç‚¹**ï¼š
- äº‹åŠ¡å¿…é¡»æ˜¯**åŸå­çš„ä¸”å¯é€†çš„**
- éœ€è¦å­˜å‚¨æ“ä½œå‰åçš„çŠ¶æ€ï¼ˆfor undo/redoï¼‰
- å†å²æ ˆå¤§å°æœ‰é™åˆ¶ï¼ˆé˜²æ­¢å†…å­˜æ³„æ¼ï¼‰
- æ–°æ“ä½œä¼š**æ¸…ç©ºä¹‹åçš„é‡åšå†å²**

**éš¾åº¦**ï¼šâ­â­â­ï¼ˆå¤æ‚çš„çŠ¶æ€ç®¡ç†é€»è¾‘ï¼‰

---

#### 3ï¸âƒ£ **useMarkdown** - Markdown æ ¼å¼åŒ–ï¼ˆä¸­ç­‰ï¼‰

**ç›®çš„**ï¼šå¤„ç† Markdown æ ¼å¼çš„åº”ç”¨ï¼Œå®ç°æ ¼å¼åŒ–æ“ä½œ

**æ ¸å¿ƒèŒè´£**ï¼š
```typescript
export function useMarkdown(
  state: EditorState,
  selection: SelectionInfo,
  history: ReturnType<typeof useHistory>
) {
  // åº”ç”¨æµ®åŠ¨å·¥å…·æ æ“ä½œï¼ˆåŠ ç²—ã€æ–œä½“ã€é“¾æ¥ç­‰ï¼‰
  const applyFormat = (action: FloatingActionType): void => { ... }
  
  // æ’å…¥å—çº§å…ƒç´ ï¼ˆä»£ç å—ã€è¡¨æ ¼ã€æ ‡é¢˜ç­‰ï¼‰
  const insertBlock = (action: BlockActionType, position?: number): void => { ... }
  
  // å°†é€‰ä¸­æ–‡æœ¬è½¬æ¢ä¸º Markdown è¯­æ³•
  const wrapWithMarkdown = (before: string, after: string): void => { ... }
  
  // å°† Markdown å†…å®¹è½¬æ¢ä¸º HTMLï¼ˆç”¨äºé¢„è§ˆï¼‰
  const markdownToHtml = (markdown: string): string => { ... }
  
  // è·å–å½“å‰å…‰æ ‡æ‰€åœ¨è¡Œçš„è¯­æ³•ç±»å‹ï¼ˆç”¨äºåˆ¤æ–­æ˜¯å¦å·²åº”ç”¨æ ¼å¼ï¼‰
  const getCurrentFormat = (): { isBold: boolean; isItalic: boolean; ... } => { ... }
  
  return { applyFormat, insertBlock, wrapWithMarkdown, markdownToHtml, getCurrentFormat }
}
```

**æ ¸å¿ƒå®ç°ç¤ºä¾‹**ï¼š
```typescript
// åº”ç”¨åŠ ç²—
applyFormat('bold') {
  const { selectedText, start, end } = selection.getSelection();
  if (!selectedText) return;
  
  // æ£€æŸ¥æ˜¯å¦å·²åŠ ç²—ï¼ˆå¦‚æœå·²åŠ ç²—åˆ™å–æ¶ˆï¼‰
  if (selectedText.startsWith('**') && selectedText.endsWith('**')) {
    // ç§»é™¤åŠ ç²—æ ‡è®°
    const unwrapped = selectedText.slice(2, -2);
    editor.replaceRange(start, end, unwrapped);
  } else {
    // æ·»åŠ åŠ ç²—æ ‡è®°
    const wrapped = `**${selectedText}**`;
    editor.replaceRange(start, end, wrapped);
  }
  
  // è®°å½•äº‹åŠ¡åˆ°å†å²
  history.addTransaction({
    id: generateId(),
    label: `åº”ç”¨åŠ ç²—`,
    actions: [{ type: 'format', content: wrapped, start, end }],
    timestamp: Date.now(),
  });
}
```

**Markdown æ“ä½œçŸ©é˜µ**ï¼š

| æ“ä½œ        | Markdown è¯­æ³•        | ä½œç”¨èŒƒå›´ |
| --------- | ------------------ | ---- |
| bold      | `**text**`         | é€‰ä¸­æ–‡æœ¬ |
| italic    | `*text*`           | é€‰ä¸­æ–‡æœ¬ |
| code      | `` `text` ``       | é€‰ä¸­æ–‡æœ¬ |
| link      | `[text](url)`      | é€‰ä¸­æ–‡æœ¬ |
| heading1  | `# text`           | æ•´è¡Œ   |
| heading2  | `## text`          | æ•´è¡Œ   |
| heading3  | `### text`         | æ•´è¡Œ   |
| quote     | `> text`           | æ•´æ®µ   |
| codeBlock | ```` ```js``` ```` | code |
| table     | \| col \| col \|   | æ–°å—   |
| image     | `![alt](url)`      | æ–°å—   |
| video     | è‡ªå®šä¹‰è¯­æ³•              | æ–°å—   |
| embedLink | è‡ªå®šä¹‰è¯­æ³•              | æ–°å—   |
| newpart   | `---`              | æ–°å—   |


**éš¾åº¦**ï¼šâ­â­â­â­ï¼ˆéœ€è¦ç†è§£ Markdown è¯­æ³•å’Œå­—ç¬¦ä¸²æ“ä½œï¼‰

---

#### 4ï¸âƒ£ **useAutoSave** - è‡ªåŠ¨ä¿å­˜ï¼ˆå¼‚æ­¥å¤„ç†ï¼‰

**ç›®çš„**ï¼šå®ç°æ··åˆæ–¹æ¡ˆçš„æœ¬åœ°+æœåŠ¡å™¨è‡ªåŠ¨ä¿å­˜

**æ ¸å¿ƒèŒè´£**ï¼š
```typescript
export function useAutoSave(
  state: EditorState,
  config: EditorConfig
) {
  // ä¿å­˜åˆ° localStorageï¼ˆåŒæ­¥ã€å¿«é€Ÿï¼‰
  const saveLocal = (): void => { ... }
  
  // ä¿å­˜åˆ°æœåŠ¡å™¨ï¼ˆå¼‚æ­¥ã€å¸¦é‡è¯•ï¼‰
  const saveToServer = (): Promise<void> => { ... }
  
  // å¯åŠ¨è‡ªåŠ¨ä¿å­˜å®šæ—¶å™¨
  const startAutoSave = (): void => { ... }
  
  // åœæ­¢è‡ªåŠ¨ä¿å­˜å®šæ—¶å™¨
  const stopAutoSave = (): void => { ... }
  
  // ä» localStorage æ¢å¤è‰ç¨¿
  const loadDraft = (): EditorState | null => { ... }
  
  // æ¸…é™¤æœ¬åœ°è‰ç¨¿
  const clearDraft = (): void => { ... }
  
  // æ‰‹åŠ¨ä¿å­˜ï¼ˆç”¨æˆ·ç‚¹å‡»ä¿å­˜æŒ‰é’®æ—¶ï¼‰
  const save = (): Promise<void> => { ... }
  
  return { saveLocal, saveToServer, startAutoSave, stopAutoSave, loadDraft, clearDraft, save }
}
```

**æ··åˆæ–¹æ¡ˆå®ç°ç»†èŠ‚**ï¼š
```typescript
// å¯åŠ¨è‡ªåŠ¨ä¿å­˜
startAutoSave() {
  // æ–¹æ¡ˆAï¼šä»…æœ¬åœ°ä¿å­˜
  if (config.autoSave?.storage === 'localStorage') {
    localInterval = setInterval(() => {
      saveLocal();  // æ¯ 2ç§’ä¿å­˜ä¸€æ¬¡ï¼ˆå¿«é€Ÿï¼‰
    }, 2000);
  }
  
  // æ–¹æ¡ˆBï¼šä»…æœåŠ¡å™¨ä¿å­˜
  if (config.autoSave?.storage === 'api') {
    apiInterval = setInterval(() => {
      saveToServer().catch(err => {
        // å¤±è´¥è®°å½•é”™è¯¯ï¼Œä½†ä¸ä¸­æ–­ç”¨æˆ·æ“ä½œ
        console.warn('æœåŠ¡å™¨ä¿å­˜å¤±è´¥:', err);
      });
    }, 10000);  // æ¯ 10ç§’ä¿å­˜ä¸€æ¬¡ï¼ˆä½é¢‘ï¼‰
  }
  
  // æ–¹æ¡ˆCï¼šæ··åˆä¿å­˜ï¼ˆæ¨èï¼‰
  if (config.autoSave?.storage === 'both') {
    // æœ¬åœ°ï¼šé«˜é¢‘ã€åŒæ­¥
    localInterval = setInterval(() => {
      saveLocal();  // 2ç§’
    }, 2000);
    
    // æœåŠ¡å™¨ï¼šä½é¢‘ã€å¼‚æ­¥
    apiInterval = setInterval(() => {
      saveToServer().catch(err => {
        // æœåŠ¡å™¨å¤±è´¥ä¸å½±å“ç”¨æˆ·ï¼Œæœ¬åœ°æœ‰å¤‡ä»½
      });
    }, 10000);  // 10ç§’
  }
  
  // é¡µé¢å¸è½½å‰å¼ºåˆ¶ä¿å­˜
  window.addEventListener('beforeunload', () => {
    if (config.autoSave?.saveOnBeforeUnload !== false) {
      save();  // åŒæ­¥ä¿å­˜ï¼Œä¸èƒ½æ˜¯å¼‚æ­¥
    }
  });
}
```

**é”™è¯¯å¤„ç†å’Œé‡è¯•**ï¼š
```typescript
async saveToServer() {
  let retries = 0;
  const maxRetries = config.autoSave?.maxRetries ?? 3;
  const retryDelay = config.autoSave?.retryDelay ?? 1000;
  
  while (retries < maxRetries) {
    try {
      const response = await fetch(config.autoSave?.apiUrl, {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({
          title: state.title,
          content: state.content,
          timestamp: Date.now(),
        }),
      });
      
      if (response.ok) {
        state.lastSaved = new Date();
        return;  // æˆåŠŸ
      }
      
      // æœåŠ¡å™¨é”™è¯¯ï¼Œé‡è¯•
      retries++;
      await sleep(retryDelay * retries);  // æŒ‡æ•°é€€é¿
    } catch (error) {
      retries++;
      await sleep(retryDelay * retries);
    }
  }
  
  // æ‰€æœ‰é‡è¯•éƒ½å¤±è´¥ï¼Œè®°å½•é”™è¯¯ä½†ä¸æŠ›å‡º
  console.error('è‡ªåŠ¨ä¿å­˜å¤±è´¥ï¼Œæœ¬åœ°æœ‰å¤‡ä»½');
}
```

**éš¾åº¦**ï¼šâ­â­â­ï¼ˆå¼‚æ­¥å¤„ç†ã€é‡è¯•é€»è¾‘ã€æ··åˆæ–¹æ¡ˆï¼‰

---

#### 5ï¸âƒ£ **useMarkdownEditor** - ä¸» Composableï¼ˆåè°ƒå±‚ï¼‰

**ç›®çš„**ï¼šåè°ƒå…¶ä»– 4 ä¸ª Composableï¼Œæš´éœ²ç»Ÿä¸€çš„ç¼–è¾‘å™¨ API

**æ ¸å¿ƒèŒè´£**ï¼š
```typescript
export function useMarkdownEditor(config: EditorConfig) {
  // 1. åˆå§‹åŒ–çŠ¶æ€
  const state = reactive<EditorState>({
    title: config.title ?? '',
    content: config.content ?? '',
    transactions: [],
    currentIndex: -1,
    selection: { start: 0, end: 0, selectedText: '', isEmpty: true },
    isSaving: false,
    isDirty: false,
    isFocused: false,
    hasError: false,
    canUndo: false,
    canRedo: false,
  });
  
  // 2. åˆå§‹åŒ–å­ Composable
  const editorRef = ref<HTMLDivElement>(null);
  const history = useHistory(state, config);
  const selection = useSelection(editorRef, state);
  const markdown = useMarkdown(state, state.selection, history);
  const autoSave = useAutoSave(state, config);
  
  // 3. æš´éœ²çš„å…¬å¼€ APIï¼ˆå¯¹å¤–æ¥å£ï¼‰
  
  // å†…å®¹æ“ä½œ
  const insertTransaction = (tx: EditTransaction) => {
    history.addTransaction(tx);
    state.isDirty = true;
  };
  
  const undo = () => {
    history.undo();
    state.isDirty = true;
  };
  
  const redo = () => {
    history.redo();
    state.isDirty = true;
  };
  
  // æ ¼å¼åŒ–æ“ä½œ
  const formatSelection = (action: FloatingActionType) => {
    markdown.applyFormat(action);
    state.isDirty = true;
  };
  
  const insertContent = (action: BlockActionType, position?: number) => {
    markdown.insertBlock(action, position);
    state.isDirty = true;
  };
  
  // ä¿å­˜æ“ä½œ
  const save = async () => {
    try {
      state.isSaving = true;
      await autoSave.save();
      state.isDirty = false;
      state.lastSaved = new Date();
    } catch (error) {
      state.hasError = true;
      state.error = {
        code: 'SAVE_ERROR',
        message: 'ä¿å­˜å¤±è´¥',
        originalError: error as Error,
        timestamp: Date.now(),
        recoverable: true,
      };
    } finally {
      state.isSaving = false;
    }
  };
  
  // 4. ç”Ÿå‘½å‘¨æœŸ
  onMounted(() => {
    // ä» localStorage æ¢å¤è‰ç¨¿
    const draft = autoSave.loadDraft();
    if (draft) {
      state.content = draft.content;
      state.title = draft.title;
    }
    
    // å¯åŠ¨è‡ªåŠ¨ä¿å­˜
    autoSave.startAutoSave();
    
    // ç›‘å¬å†…å®¹å˜åŒ–ï¼ˆdebounce 500msï¼‰
    watch(
      () => [state.content, state.title],
      debounce(() => {
        autoSave.saveLocal();  // ä¿å­˜è‰ç¨¿
      }, 500)
    );
  });
  
  onBeforeUnmount(() => {
    autoSave.stopAutoSave();
  });
  
  // 5. è¿”å›æš´éœ²çš„ API
  return {
    // çŠ¶æ€ï¼ˆåªè¯»ï¼‰
    state: readonly(state),
    
    // æ“ä½œæ–¹æ³•
    insertTransaction,
    undo,
    redo,
    formatSelection,
    insertContent,
    save,
    
    // å·¥å…·æ–¹æ³•
    getSelection: () => selection.getSelection(),
    setCursor: (pos: number) => selection.setCursor(pos),
    clearDraft: () => autoSave.clearDraft(),
    
    // æŸ¥è¯¢æ–¹æ³•
    canUndo: () => history.canUndo(),
    canRedo: () => history.canRedo(),
  };
}
```

**éš¾åº¦**ï¼šâ­â­ï¼ˆç›¸å¯¹ç®€å•ï¼Œä¸»è¦æ˜¯åè°ƒå’Œæš´éœ² APIï¼‰

---

### å®ç°é¡ºåºå’Œä¾èµ–å…³ç³»

```
å®ç°é¡ºåºï¼ˆä»ä¸‹å¾€ä¸Šï¼Œåº•å±‚ä¼˜å…ˆï¼‰ï¼š

1ï¸âƒ£ useSelection
   â”œâ”€ ä¾èµ–ï¼šEditorState, æµè§ˆå™¨ Selection API
   â”œâ”€ è¢«ä¾èµ–ï¼šuseMarkdown, useMarkdownEditor
   â””â”€ é¢„æœŸå®ç°æ—¶é—´ï¼š2-3 å°æ—¶

2ï¸âƒ£ useHistory
   â”œâ”€ ä¾èµ–ï¼šEditorState, EditorConfig
   â”œâ”€ è¢«ä¾èµ–ï¼šuseMarkdown, useMarkdownEditor
   â””â”€ é¢„æœŸå®ç°æ—¶é—´ï¼š4-5 å°æ—¶ï¼ˆæ ¸å¿ƒå¤æ‚ï¼‰

3ï¸âƒ£ useMarkdown
   â”œâ”€ ä¾èµ–ï¼šEditorState, SelectionInfo, useHistory
   â”œâ”€ è¢«ä¾èµ–ï¼šuseMarkdownEditor
   â””â”€ é¢„æœŸå®ç°æ—¶é—´ï¼š3-4 å°æ—¶

4ï¸âƒ£ useAutoSave
   â”œâ”€ ä¾èµ–ï¼šEditorState, EditorConfig, HTTP client
   â”œâ”€ è¢«ä¾èµ–ï¼šuseMarkdownEditor
   â””â”€ é¢„æœŸå®ç°æ—¶é—´ï¼š3-4 å°æ—¶

5ï¸âƒ£ useMarkdownEditor
   â”œâ”€ ä¾èµ–ï¼šæ‰€æœ‰ä»¥ä¸Š 4 ä¸ª Composable
   â”œâ”€ è¢«ä¾èµ–ï¼šUI ç»„ä»¶
   â””â”€ é¢„æœŸå®ç°æ—¶é—´ï¼š2-3 å°æ—¶ï¼ˆç»„è£…ï¼‰

æ€»è®¡ï¼šçº¦ 14-19 å°æ—¶ï¼ˆ2-3 å¤©å¼€å‘ï¼‰
```

---

### å…³é”®è®¾è®¡åŸåˆ™

#### ğŸ¯ åŸåˆ™ 1ï¼šå•ä¸€èŒè´£
- æ¯ä¸ª Composable åªè´Ÿè´£**ä¸€ä¸ªæ˜ç¡®çš„åŠŸèƒ½åŸŸ**
- ä¾‹å¦‚ï¼šuseSelection åªç®¡ç†é€‰ä¸­çŠ¶æ€ï¼Œä¸æ¶‰åŠæ ¼å¼åŒ–é€»è¾‘

#### ğŸ¯ åŸåˆ™ 2ï¼šä¾èµ–æ³¨å…¥
- å­ Composable ä¸åˆ›å»ºè‡ªå·±çš„çŠ¶æ€ï¼Œæ¥æ”¶å¤–éƒ¨çš„ state å’Œ config
- è¿™æ ·ä¾¿äºæµ‹è¯•å’Œå¤ç”¨

#### ğŸ¯ åŸåˆ™ 3ï¼šå¯æµ‹è¯•æ€§
- æ‰€æœ‰é€»è¾‘éƒ½æ˜¯çº¯å‡½æ•°ï¼ˆé™¤äº†å‰¯ä½œç”¨å¦‚ DOM æ“ä½œï¼‰
- ä¸ä¾èµ–å…¨å±€çŠ¶æ€ï¼Œæ˜“äºå•å…ƒæµ‹è¯•

#### ğŸ¯ åŸåˆ™ 4ï¼šæ¸è¿›å¼åŠŸèƒ½
- å¯ä»¥ç‹¬ç«‹ä½¿ç”¨ä»»ä½•ä¸€ä¸ª Composable
- ä¹Ÿå¯ä»¥é€šè¿‡ useMarkdownEditor æ•´åˆä½¿ç”¨

---

### æµ‹è¯•ç­–ç•¥

æ¯ä¸ª Composable éƒ½éœ€è¦å®Œæ•´çš„å•å…ƒæµ‹è¯•ï¼š

```typescript
// __tests__/useSelection.spec.ts
describe('useSelection', () => {
  test('åº”è¯¥è¿”å›å½“å‰é€‰ä¸­çš„æ–‡æœ¬èŒƒå›´', () => { ... });
  test('åº”è¯¥æ”¯æŒè®¾ç½®å…‰æ ‡ä½ç½®', () => { ... });
  test('åº”è¯¥æ”¯æŒåŒ…è£¹é€‰ä¸­æ–‡æœ¬', () => { ... });
  // ...æ€»è®¡ 8-10 ä¸ªæµ‹è¯•ç”¨ä¾‹
});

// __tests__/useHistory.spec.ts
describe('useHistory', () => {
  test('åº”è¯¥æ·»åŠ äº‹åŠ¡åˆ°å†å²', () => { ... });
  test('æ’¤é”€åº”è¯¥å›åˆ°ä¸Šä¸€ä¸ªçŠ¶æ€', () => { ... });
  test('é‡åšåº”è¯¥å‰è¿›åˆ°ä¸‹ä¸€ä¸ªçŠ¶æ€', () => { ... });
  test('æ–°æ“ä½œåº”è¯¥æ¸…ç©ºä¹‹åçš„é‡åšå†å²', () => { ... });
  // ...æ€»è®¡ 12-15 ä¸ªæµ‹è¯•ç”¨ä¾‹ï¼ˆæœ€å¤æ‚ï¼‰
});

// ...å…¶ä»– Composable ç±»ä¼¼
```

**æµ‹è¯•è¦†ç›–ç›®æ ‡**ï¼šâ‰¥ 85%ï¼ˆé‡ç‚¹æ˜¯æ ¸å¿ƒé€»è¾‘ï¼‰

---

## ğŸ“ æ¨¡å—ç»“æ„

### å®Œæ•´çš„æ–‡ä»¶ç»“æ„

```
frontend/src/components/editor/
â”‚
â”œâ”€â”€ ğŸ“„ MarkdownEditor.vue          â† ä¸»ç¼–è¾‘å™¨ç»„ä»¶
â”‚
â”œâ”€â”€ ğŸ“ sub-components/
â”‚   â”œâ”€â”€ EditorHeader.vue           â† å¤´éƒ¨ï¼ˆä¿å­˜çŠ¶æ€ã€å·¥å…·é€‰é¡¹ï¼‰
â”‚   â”œâ”€â”€ EditorTitle.vue            â† æ ‡é¢˜è¾“å…¥æ¡† (contenteditable)
â”‚   â”œâ”€â”€ EditorContent.vue          â† æ­£æ–‡ç¼–è¾‘åŒº (contenteditable + WYSIWYG)
â”‚   â”œâ”€â”€ EditorToolbar.vue          â† æµ®åŠ¨å·¥å…·æ ï¼ˆé€‰ä¸­æ—¶å‡ºç°ï¼‰
â”‚   â””â”€â”€ EditorFooter.vue           â† é¡µè„šï¼ˆå­—æ•°ã€é˜…è¯»æ—¶é—´ï¼‰
â”‚
â”œâ”€â”€ ğŸ“ composables/
â”‚   â”œâ”€â”€ useMarkdownEditor.ts       â† æ ¸å¿ƒç¼–è¾‘é€»è¾‘
â”‚   â”œâ”€â”€ useToolbar.ts              â† å·¥å…·æ çŠ¶æ€ç®¡ç†
â”‚   â”œâ”€â”€ useAutoSave.ts             â† è‡ªåŠ¨ä¿å­˜é€»è¾‘
â”‚   â””â”€â”€ useShortcuts.ts            â† å¿«æ·é”®å¤„ç†
â”‚
â”œâ”€â”€ ğŸ“ utils/
â”‚   â”œâ”€â”€ markdown.ts                â† Markdownè§£æå’Œæ¸²æŸ“
â”‚   â”œâ”€â”€ selection.ts               â† é€‰ä¸­æ–‡æœ¬å’Œå…‰æ ‡æ“ä½œ
â”‚   â”œâ”€â”€ editor-helpers.ts          â† ç¼–è¾‘å™¨è¾…åŠ©å‡½æ•°
â”‚   â””â”€â”€ sanitize.ts                â† HTMLå®‰å…¨å¤„ç†ï¼ˆé˜²XSSï¼‰
â”‚
â”œâ”€â”€ ğŸ“ types/
â”‚   â””â”€â”€ editor.ts                  â† ç±»å‹å®šä¹‰
â”‚
â”œâ”€â”€ ğŸ“ styles/
â”‚   â””â”€â”€ editor.css                 â† ç¼–è¾‘å™¨æ ·å¼
â”‚
â”œâ”€â”€ ğŸ“ __tests__/
â”‚   â”œâ”€â”€ MarkdownEditor.spec.ts     â† ä¸»ç»„ä»¶æµ‹è¯•
â”‚   â”œâ”€â”€ useMarkdownEditor.spec.ts  â† Composableæµ‹è¯•
â”‚   â””â”€â”€ editor-utils.spec.ts       â† å·¥å…·å‡½æ•°æµ‹è¯•
â”‚
â””â”€â”€ ğŸ“„ README.md                   â† ä½¿ç”¨æ–‡æ¡£
```

### å„æ–‡ä»¶è¯¦ç»†è¯´æ˜

#### **MarkdownEditor.vue** (ä¸»ç»„ä»¶)
```
è´Ÿè´£ï¼š
- ç®¡ç†ç¼–è¾‘å™¨æ€»ä½“çŠ¶æ€
- åè°ƒå­ç»„ä»¶é€šä¿¡
- å¤„ç† v-model åŒå‘ç»‘å®š
- æä¾›é…ç½®å’Œæ’ä»¶ç³»ç»Ÿæ”¯æŒ
```

#### **composables/** (ç¼–è¾‘é€»è¾‘)
```
useMarkdownEditor:
  - ç¼–è¾‘å†…å®¹çš„å¢åˆ æ”¹æŸ¥
  - å…‰æ ‡ä½ç½®ç®¡ç†
  - é€‰ä¸­æ–‡æœ¬å¤„ç†
  - æ’¤é”€é‡åšå†å²

useToolbar:
  - å·¥å…·æ æ˜¾ç¤º/éšè—é€»è¾‘
  - æŒ‰é’®æ¿€æ´»çŠ¶æ€
  - ç‚¹å‡»å¤„ç†

useAutoSave:
  - å®šæ—¶ä¿å­˜é€»è¾‘
  - localStorage å­˜å‚¨
  - API åŒæ­¥

useShortcuts:
  - å¿«æ·é”®ç»‘å®š
  - å¿«æ·é”®æ‰§è¡Œ
```

#### **utils/** (çº¯å‡½æ•°)
```
markdown.ts:
  - marked.parse() åŒ…è£…
  - ä»£ç é«˜äº®å¤„ç†
  - GFM æ‰©å±•æ”¯æŒ

selection.ts:
  - è·å–é€‰ä¸­æ–‡æœ¬èŒƒå›´
  - è®¾ç½®å…‰æ ‡ä½ç½®
  - åŒ…è£¹æ–‡æœ¬ï¼ˆåŠ ç²—ã€æ–œä½“ç­‰ï¼‰

editor-helpers.ts:
  - æ’å…¥æ ‡é¢˜
  - æ’å…¥é“¾æ¥
  - æ’å…¥ä»£ç å—
  - æ’å…¥è¡¨æ ¼
```

---

## ğŸ”Œ API è®¾è®¡

### 1. Props é…ç½®ï¼ˆå®Œæ•´çš„ç»„ä»¶APIï¼‰

```typescript
interface EditorProps {
  // å†…å®¹ç»‘å®š
  modelValue?: string;                    // v-model å†…å®¹
  title?: string;                         // æ–‡ç« æ ‡é¢˜
  
  // ç¼–è¾‘å™¨æ˜¾ç¤ºæ¨¡å¼
  displayMode?: 'compact' | 'normal' | 'fullscreen';  // ç´§å‡‘ / æ­£å¸¸ / å…¨å±
  
  // å°ºå¯¸é…ç½®
  minHeight?: string;                     // æœ€å°é«˜åº¦
  maxHeight?: string;                     // æœ€å¤§é«˜åº¦
  
  // åŠŸèƒ½å¼€å…³
  features?: {
    toolbar?: boolean;                    // æ˜¯å¦æ˜¾ç¤ºå·¥å…·æ 
    autoSave?: boolean;                   // æ˜¯å¦è‡ªåŠ¨ä¿å­˜
    footer?: boolean;                     // æ˜¯å¦æ˜¾ç¤ºé¡µè„šï¼ˆå­—æ•°ç»Ÿè®¡ï¼‰
    markdown?: boolean;                   // æ˜¯å¦æ”¯æŒMarkdownè¯­æ³•
    shortcuts?: boolean;                  // æ˜¯å¦å¯ç”¨å¿«æ·é”®
  };
  
  // å·¥å…·æ é…ç½®
  toolbarConfig?: ToolbarConfig;
  
  // è‡ªåŠ¨ä¿å­˜é…ç½®
  autoSaveConfig?: AutoSaveConfig;
  
  // åªè¯»æ¨¡å¼
  readOnly?: boolean;
  
  // å ä½ç¬¦
  placeholder?: {
    title?: string;
    content?: string;
  };
  
  // æ’ä»¶ç³»ç»Ÿ
  plugins?: EditorPlugin[];
}
```

### 2. Eventsï¼ˆå®Œæ•´çš„äº‹ä»¶ç³»ç»Ÿï¼‰

```typescript
interface EditorEmits {
  // å†…å®¹å˜åŒ–
  'update:modelValue': [content: string];
  'update:title': [title: string];
  'change': [{ title: string; content: string }];
  
  // ç¼–è¾‘äº‹ä»¶
  'input': [content: string];
  'focus': [];
  'blur': [];
  
  // ä¿å­˜äº‹ä»¶
  'save': [{ title: string; content: string }];
  'saved': [timestamp: number];
  'save-error': [error: Error];
  
  // å·¥å…·æ äº‹ä»¶
  'toolbar-action': [action: string];
  
  // è‡ªå®šä¹‰äº‹ä»¶
  'plugin-event': [{ plugin: string; data: any }];
}
```

### 3. Methodsï¼ˆç»„ä»¶æ–¹æ³•ï¼‰

```typescript
interface EditorMethods {
  // å†…å®¹æ“ä½œ
  getContent(): string;
  setContent(content: string): void;
  insertText(text: string): void;
  replaceSelection(text: string): void;
  
  // æ ¼å¼åŒ–
  bold(): void;                           // åŠ ç²—é€‰ä¸­æ–‡æœ¬
  italic(): void;                         // æ–œä½“
  insertLink(): void;                     // æ’å…¥é“¾æ¥
  insertImage(): void;                    // æ’å…¥å›¾ç‰‡
  insertCodeBlock(): void;                // æ’å…¥ä»£ç å—
  insertTable(): void;                    // æ’å…¥è¡¨æ ¼
  insertHeading(level: 1-6): void;       // æ’å…¥æ ‡é¢˜
  
  // ç¼–è¾‘å†å²
  undo(): void;                           // æ’¤é”€
  redo(): void;                           // é‡åš
  
  // çŠ¶æ€æŸ¥è¯¢
  getState(): EditorState;
  canUndo(): boolean;
  canRedo(): boolean;
  
  // å…¶ä»–
  focus(): void;                          // èšç„¦ç¼–è¾‘åŒº
  save(): Promise<void>;                  // ä¿å­˜
  export(format: 'html' | 'markdown'): string;  // å¯¼å‡º
}
```

---

## ğŸ“ ç±»å‹ç³»ç»Ÿ

### æ ¸å¿ƒç±»å‹å®šä¹‰

```typescript
// editor.ts

// ç¼–è¾‘å™¨çŠ¶æ€
interface EditorState {
  title: string;
  content: string;
  isDirty: boolean;                      // æ˜¯å¦æœ‰æœªä¿å­˜çš„æ”¹åŠ¨
  isSaving: boolean;                     // æ˜¯å¦æ­£åœ¨ä¿å­˜
  canUndo: boolean;
  canRedo: boolean;
  lastSaved?: Date;
  selectedText?: string;
}

// é€‰ä¸­æ–‡æœ¬ä¿¡æ¯
interface SelectionInfo {
  start: number;                         // é€‰ä¸­å¼€å§‹ä½ç½®
  end: number;                           // é€‰ä¸­ç»“æŸä½ç½®
  selectedText: string;                  // é€‰ä¸­çš„æ–‡æœ¬
  isEmpty: boolean;                      // æ˜¯å¦ä¸ºç©º
}

// å·¥å…·æ é…ç½®
interface ToolbarConfig {
  position?: 'floating' | 'fixed' | 'inline';  // å·¥å…·æ ä½ç½®
  items?: ToolbarItem[];                 // å·¥å…·æ æŒ‰é’®
  groups?: ToolbarGroup[];               // æŒ‰é’®ç»„
}

interface ToolbarItem {
  id: string;                            // æŒ‰é’®ID
  label: string;                         // æŒ‰é’®æ ‡ç­¾
  icon?: string;                         // å›¾æ ‡
  title?: string;                        // æç¤ºæ–‡æœ¬
  action?: string;                       // è§¦å‘çš„æ“ä½œ
  hotkey?: string;                       // å¿«æ·é”®
  disabled?: boolean;                    // æ˜¯å¦ç¦ç”¨
}

// è‡ªåŠ¨ä¿å­˜é…ç½®
interface AutoSaveConfig {
  enabled: boolean;
  interval: number;                      // ä¿å­˜é—´éš”ï¼ˆmsï¼‰
  storage: 'localStorage' | 'api' | 'both';
  apiUrl?: string;                       // API ç«¯ç‚¹
  draftKey?: string;                     // localStorage é”®
}

// æ’ä»¶æ¥å£
interface EditorPlugin {
  name: string;                          // æ’ä»¶åç§°
  version?: string;
  
  hooks?: {
    beforeParse?: (markdown: string) => string;
    afterParse?: (html: string) => string;
    beforeInsert?: (text: string) => string;
    onToolbarAction?: (action: string) => void;
    onSelectionChange?: (selection: SelectionInfo) => void;
  };
  
  commands?: Record<string, (args: any) => void>;
}

// ç¼–è¾‘æ“ä½œå†å²
interface EditAction {
  type: 'insert' | 'delete' | 'replace' | 'format';
  timestamp: number;
  content: {
    before: string;
    after: string;
    position?: number;
  };
}
```

---

## ğŸ’¡ ä½¿ç”¨ç¤ºä¾‹

### æ–¹å¼1ï¼šæœ€ç®€å•ä½¿ç”¨ï¼ˆå¼€ç®±å³ç”¨ï¼‰

```vue
<template>
  <div class="container">
    <MarkdownEditor 
      v-model="content"
      v-model:title="title"
      mode="split"
      @save="handleSave"
    />
  </div>
</template>

<script setup lang="ts">
import { ref } from 'vue';
import MarkdownEditor from '@/components/editor/MarkdownEditor.vue';

const title = ref('æˆ‘çš„æ–‡ç« ');
const content = ref('');

const handleSave = async (data: { title: string; content: string }) => {
  try {
    // è°ƒç”¨ API ä¿å­˜æ–‡ç« 
    await api.posts.create(data);
    console.log('ä¿å­˜æˆåŠŸï¼');
  } catch (error) {
    console.error('ä¿å­˜å¤±è´¥ï¼š', error);
  }
};
</script>
```

### æ–¹å¼2ï¼šå®Œå…¨å®šåˆ¶ä½¿ç”¨

```vue
<template>
  <MarkdownEditor
    v-model="content"
    :config="editorConfig"
    :plugins="customPlugins"
    mode="split"
    read-only="false"
    @save="handleSave"
    @toolbar-action="handleToolbarAction"
  />
</template>

<script setup lang="ts">
import { ref } from 'vue';
import MarkdownEditor from '@/components/editor/MarkdownEditor.vue';
import type { EditorConfig, EditorPlugin } from '@/components/editor/types';

const content = ref('');

// å®Œæ•´çš„ç¼–è¾‘å™¨é…ç½®
const editorConfig: EditorConfig = {
  mode: 'split',
  toolbarConfig: {
    position: 'floating',
    items: [
      { id: 'bold', label: 'åŠ ç²—', hotkey: 'Ctrl+B' },
      { id: 'italic', label: 'æ–œä½“', hotkey: 'Ctrl+I' },
      { id: 'link', label: 'é“¾æ¥', hotkey: 'Ctrl+K' },
      { id: 'code', label: 'ä»£ç ', hotkey: 'Ctrl+`' },
      { id: 'codeblock', label: 'ä»£ç å—', hotkey: 'Ctrl+Shift+C' },
    ],
  },
  autoSaveConfig: {
    enabled: true,
    interval: 10000, // 10s ä¿å­˜ä¸€æ¬¡
    storage: 'both',
    apiUrl: '/api/drafts/save',
    draftKey: 'article-draft',
  },
  features: {
    toolbar: true,
    autoSave: true,
    preview: true,
    markdown: true,
  },
};

// è‡ªå®šä¹‰æ’ä»¶
const customPlugins: EditorPlugin[] = [
  {
    name: 'mention-plugin',
    hooks: {
      beforeParse: (markdown) => {
        // å°† @username è½¬æ¢ä¸ºé“¾æ¥
        return markdown.replace(/@(\w+)/g, '[@$1](user/$1)');
      },
    },
  },
  {
    name: 'emoji-plugin',
    commands: {
      insertEmoji: (emoji) => {
        // æ’å…¥emoji
        editor.value?.insertText(emoji);
      },
    },
  },
];

const handleSave = async (data: any) => {
  console.log('ä¿å­˜:', data);
};

const handleToolbarAction = (action: string) => {
  console.log('å·¥å…·æ ç‚¹å‡»:', action);
};
</script>
```

### æ–¹å¼3ï¼šHeadless ä½¿ç”¨ï¼ˆä»…ç”¨é€»è¾‘ï¼‰

```typescript
// åœ¨å…¶ä»–é¡¹ç›®ä¸­ä½¿ç”¨æ ¸å¿ƒé€»è¾‘ï¼Œä¸ä½¿ç”¨UIç»„ä»¶
import { useMarkdownEditor } from '@/components/editor/composables/useMarkdownEditor';

const editor = useMarkdownEditor({
  initialContent: '# Hello',
  onChange: (content) => {
    console.log('å†…å®¹å˜åŒ–:', content);
  },
});

// ç›´æ¥è°ƒç”¨æ–¹æ³•
editor.bold();              // åŠ ç²—
editor.italic();            // æ–œä½“
editor.insertLink();        // æ’å…¥é“¾æ¥
editor.insertCodeBlock();   // æ’å…¥ä»£ç å—

// æŸ¥è¯¢çŠ¶æ€
console.log(editor.canUndo());
console.log(editor.getState());

// å¯¼å‡ºå†…å®¹
const html = marked.parse(editor.content.value);
```

---

## ğŸš€ å®ç°è·¯çº¿

### Phase 1: åŸºç¡€æ¶æ„ï¼ˆWeek 1ï¼‰

**ç›®æ ‡**ï¼šæ­å»ºç¼–è¾‘å™¨æ ¸å¿ƒæ¡†æ¶å’Œç±»å‹ç³»ç»Ÿ

- [ ] åˆ›å»ºç›®å½•ç»“æ„å’Œæ–‡ä»¶æ¡†æ¶
- [ ] ç¼–å†™å®Œæ•´çš„ TypeScript ç±»å‹å®šä¹‰ (`types/editor.ts`)
- [ ] å®ç° `useMarkdownEditor` composable çš„æ¡†æ¶
- [ ] ç¼–å†™å•å…ƒæµ‹è¯•æ¡†æ¶

**è¾“å‡ºç‰©**ï¼š
- ç±»å‹å®šä¹‰æ–‡ä»¶
- Composable åŸºç¡€å®ç°
- æµ‹è¯•å¥—ä»¶æ¡†æ¶

### Phase 2: æ ¸å¿ƒWYSIWYGåŠŸèƒ½ï¼ˆWeek 2ï¼‰

**ç›®æ ‡**ï¼šå®ç°ç¼–è¾‘å™¨çš„æ ¸å¿ƒç¼–è¾‘åŠŸèƒ½

- [ ] å®ç° contenteditable ç¼–è¾‘åŒº
- [ ] å®ç°æ–‡æœ¬é€‰ä¸­å’Œå…‰æ ‡æ“ä½œï¼ˆ`selection.ts`ï¼‰
- [ ] å®ç° Markdown è§£æå’Œæ¸²æŸ“ï¼ˆ`markdown.ts`ï¼‰
- [ ] å®ç°åŸºç¡€æ ¼å¼åŒ–æ“ä½œï¼ˆåŠ ç²—ã€æ–œä½“ã€é“¾æ¥ç­‰ï¼‰
- [ ] å®ç°ç¼–è¾‘å†å²ï¼ˆæ’¤é”€/é‡åšï¼‰

**è¾“å‡ºç‰©**ï¼š
- `EditorContent.vue` ç»„ä»¶
- `selection.ts` å·¥å…·å‡½æ•°
- `markdown.ts` å·¥å…·å‡½æ•°
- å¯¹åº”å•å…ƒæµ‹è¯•

### Phase 3: UI ç»„ä»¶ï¼ˆWeek 3ï¼‰

**ç›®æ ‡**ï¼šå®ç°å®Œæ•´çš„ç¼–è¾‘å™¨UIç»„ä»¶

- [ ] å®ç° `EditorHeader.vue` (æ ‡é¢˜è¾“å…¥ã€ä¿å­˜çŠ¶æ€)
- [ ] å®ç° `EditorToolbar.vue` (æµ®åŠ¨å·¥å…·æ )
- [ ] å®ç° `PreviewPanel.vue` (Markdown é¢„è§ˆ)
- [ ] å®ç° `MarkdownEditor.vue` (ä¸»å®¹å™¨)
- [ ] åº”ç”¨è®¾è®¡ç³»ç»Ÿæ ·å¼

**è¾“å‡ºç‰©**ï¼š
- æ‰€æœ‰ Vue ç»„ä»¶
- ç¼–è¾‘å™¨æ ·å¼æ–‡ä»¶
- ç»„ä»¶é›†æˆæµ‹è¯•

### Phase 4: å¢å¼ºåŠŸèƒ½ï¼ˆWeek 4ï¼‰

**ç›®æ ‡**ï¼šå®ç°è‡ªåŠ¨ä¿å­˜ã€å¿«æ·é”®ã€æ’ä»¶ç³»ç»Ÿ

- [ ] å®ç° `useAutoSave` composable
- [ ] å®ç° `useShortcuts` composable
- [ ] å®ç°æ’ä»¶ç³»ç»Ÿæ¡†æ¶
- [ ] å®ç°è¾…åŠ©ç¼–è¾‘å‡½æ•° (`editor-helpers.ts`)
- [ ] ç¼–å†™é›†æˆæµ‹è¯•

**è¾“å‡ºç‰©**ï¼š
- è‡ªåŠ¨ä¿å­˜é€»è¾‘
- å¿«æ·é”®ç³»ç»Ÿ
- æ’ä»¶æ¥å£å®ç°
- é›†æˆæµ‹è¯•

### Phase 5: æ–‡æ¡£å’Œä¼˜åŒ–ï¼ˆWeek 5ï¼‰

**ç›®æ ‡**ï¼šå®Œå–„æ–‡æ¡£ã€æ€§èƒ½ä¼˜åŒ–ã€å‘å¸ƒ

- [ ] ç¼–å†™ `README.md` (ä½¿ç”¨æ–‡æ¡£)
- [ ] ç¼–å†™ç¤ºä¾‹é¡¹ç›®
- [ ] æ€§èƒ½ä¼˜åŒ–ï¼ˆé˜²æŠ–ã€è™šæ‹ŸåŒ–ç­‰ï¼‰
- [ ] ä»£ç å®¡æŸ¥å’Œä¼˜åŒ–
- [ ] å‘å¸ƒ npm åŒ…ï¼ˆå¯é€‰ï¼‰

**è¾“å‡ºç‰©**ï¼š
- å®Œæ•´ä½¿ç”¨æ–‡æ¡£
- ç¤ºä¾‹ä»£ç 
- npm å‘å¸ƒé…ç½®ï¼ˆå¯é€‰ï¼‰

---

## ğŸ“Š æ–‡ä»¶æ¸…å•

| æ–‡ä»¶ | ä¼˜å…ˆçº§ | å‘¨æ¬¡ | è¯´æ˜ |
|------|--------|------|------|
| `types/editor.ts` | P0 | 1 | ç±»å‹å®šä¹‰ï¼Œæ‰€æœ‰æ–‡ä»¶çš„åŸºç¡€ |
| `composables/useMarkdownEditor.ts` | P0 | 1-2 | æ ¸å¿ƒç¼–è¾‘é€»è¾‘ |
| `utils/selection.ts` | P0 | 2 | å…‰æ ‡å’Œé€‰ä¸­æ“ä½œ |
| `utils/markdown.ts` | P0 | 2 | Markdown è§£ææ¸²æŸ“ |
| `sub-components/EditorContent.vue` | P0 | 2 | ç¼–è¾‘åŒºæ ¸å¿ƒç»„ä»¶ |
| `EditorTitle.vue` | P1 | 2 | æ ‡é¢˜è¾“å…¥æ¡† |
| `EditorHeader.vue` | P1 | 3 | å¤´éƒ¨ï¼ˆä¿å­˜çŠ¶æ€ç­‰ï¼‰ |
| `EditorToolbar.vue` | P1 | 3 | æµ®åŠ¨å·¥å…·æ  |
| `EditorFooter.vue` | P2 | 4 | é¡µè„šï¼ˆå­—æ•°ã€æ—¶é—´ï¼‰ |
| `MarkdownEditor.vue` | P0 | 3 | ä¸»ç»„ä»¶ |
| `composables/useAutoSave.ts` | P2 | 4 | è‡ªåŠ¨ä¿å­˜ |
| `composables/useShortcuts.ts` | P2 | 4 | å¿«æ·é”® |
| `utils/editor-helpers.ts` | P2 | 4 | è¾…åŠ©å‡½æ•° |
| `styles/editor.css` | P1 | 3 | æ ·å¼æ–‡ä»¶ |
| `__tests__/*` | P1 | 1-5 | æµ‹è¯•æ–‡ä»¶ |
| `README.md` | P1 | 5 | ä½¿ç”¨æ–‡æ¡£ |

---

## âœ… éªŒæ”¶æ ‡å‡†

### åŠŸèƒ½å®Œæ•´æ€§
- [ ] æ”¯æŒåŸºç¡€ Markdown æ ¼å¼ï¼ˆæ ‡é¢˜ã€åŠ ç²—ã€æ–œä½“ã€åˆ—è¡¨ã€é“¾æ¥ï¼‰
- [ ] å®æ—¶é¢„è§ˆåŠŸèƒ½æ­£å¸¸
- [ ] å·¥å…·æ æ‰€æœ‰æŒ‰é’®å¯ç”¨
- [ ] å¿«æ·é”®å“åº”æ­£ç¡®
- [ ] è‡ªåŠ¨ä¿å­˜åŠŸèƒ½æ­£å¸¸

### ä»£ç è´¨é‡
- [ ] æµ‹è¯•è¦†ç›–ç‡ â‰¥ 85%
- [ ] TypeScript æ— é”™è¯¯å’Œè­¦å‘Š
- [ ] ESLint æ£€æŸ¥é€šè¿‡
- [ ] æ‰€æœ‰å…¬å…± API æœ‰æ–‡æ¡£æ³¨é‡Š

### æ€§èƒ½æŒ‡æ ‡
- [ ] ç¼–è¾‘å“åº”æ—¶é—´ < 100ms
- [ ] é¢„è§ˆæ¸²æŸ“æ—¶é—´ < 300ms
- [ ] å¤§æ–‡æ¡£ï¼ˆ10000+ å­—ï¼‰å¯æ­£å¸¸ç¼–è¾‘
- [ ] å†…å­˜å ç”¨ç¨³å®šï¼Œæ— æ³„æ¼

### ç”¨æˆ·ä½“éªŒ
- [ ] Medium é£æ ¼çš„ç¼–è¾‘ä½“éªŒ
- [ ] æµç•…çš„åŠ¨ç”»è¿‡æ¸¡
- [ ] æ¸…æ™°çš„è§†è§‰åé¦ˆ
- [ ] æ˜“æ‡‚çš„é”™è¯¯æç¤º

---

## ğŸ”— ç›¸å…³æ–‡æ¡£

- [phase1_design_system.md](./phase1_design_system.md) - é¡¹ç›®è®¾è®¡ç³»ç»Ÿ
- [frontend-styles.md](./frontend-styles.md) - Tailwind CSS è§„èŒƒ
- [process.md](../project/process.md) - é¡¹ç›®è¿›åº¦

---

## ğŸ“ ç‰ˆæœ¬å†å²

| ç‰ˆæœ¬ | æ—¥æœŸ | å†…å®¹ |
|------|------|------|
| v1.0 | 2025-11-18 | åˆå§‹è®¾è®¡æ–‡æ¡£ |

---

**ä¸‹ä¸€æ­¥**ï¼šç­‰å¾…ç¡®è®¤åå¼€å§‹å®ç° Phase 1 çš„ç±»å‹å®šä¹‰å’Œæ ¸å¿ƒ Composableã€‚
