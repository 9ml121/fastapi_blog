# å‰ç«¯å¼‚å¸¸å¤„ç†æœ€ä½³å®è·µ

> æœ¬æ–‡æ¡£æ€»ç»“äº†å‰ç«¯å¼€å‘ä¸­é”™è¯¯å¤„ç†çš„å®Œæ•´æ–¹æ¡ˆï¼Œä»åŸºç¡€æ¦‚å¿µåˆ°ä¼ä¸šçº§å®è·µï¼Œå¸®åŠ©ä½ æ„å»ºå¥å£®çš„å‰ç«¯åº”ç”¨ã€‚

---

## ğŸ“š ç›®å½•

1. [ä¸ºä»€ä¹ˆéœ€è¦ç»Ÿä¸€çš„é”™è¯¯å¤„ç†](#ä¸ºä»€ä¹ˆéœ€è¦ç»Ÿä¸€çš„é”™è¯¯å¤„ç†)
2. [é”™è¯¯å¤„ç†çš„ä¸‰å±‚æ¶æ„](#é”™è¯¯å¤„ç†çš„ä¸‰å±‚æ¶æ„)
3. [TypeScript ç±»å‹å®‰å…¨](#typescript-ç±»å‹å®‰å…¨)
4. [å®æˆ˜ï¼šæœ¬é¡¹ç›®çš„é”™è¯¯å¤„ç†æ–¹æ¡ˆ](#å®æˆ˜æœ¬é¡¹ç›®çš„é”™è¯¯å¤„ç†æ–¹æ¡ˆ)
5. [å¸¸è§è¯¯åŒºä¸æœ€ä½³å®è·µ](#å¸¸è§è¯¯åŒºä¸æœ€ä½³å®è·µ)
6. [è¿›é˜¶ï¼šç±»å‹å®ˆå«è¯¦è§£](#è¿›é˜¶ç±»å‹å®ˆå«è¯¦è§£)

---

## ä¸ºä»€ä¹ˆéœ€è¦ç»Ÿä¸€çš„é”™è¯¯å¤„ç†

### âŒ é—®é¢˜ä»£ç ï¼ˆåˆå­¦è€…å¸¸è§ï¼‰

```typescript
// æ¯ä¸ª catch å—éƒ½å†™ä¸€éå†—é•¿çš„é”™è¯¯æå–é€»è¾‘
try {
  await sendCodeApi(email.value)
} catch (error: any) {
  if (error.response?.data?.error?.message) {
    errors.value.email = error.response.data.error.message
  } else {
    alert('å‘é€éªŒè¯ç å¤±è´¥ï¼Œè¯·ç¨åé‡è¯•')  // âŒ ç”¨æˆ·ä½“éªŒå·®
  }
}

try {
  await authStore.register({ ... })
} catch (error: any) {
  // âŒ é‡å¤ä»£ç 
  if (error.response?.data?.error?.message) {
    alert(error.response.data.error.message)
  } else {
    alert('æ³¨å†Œå¤±è´¥ï¼Œè¯·é‡è¯•')
  }
}
```

**é—®é¢˜**ï¼š
1. ä»£ç é‡å¤ï¼ˆè¿å DRY åŸåˆ™ï¼‰
2. ç±»å‹ä¸å®‰å…¨ï¼ˆ`error: any`ï¼‰
3. ç”¨æˆ·ä½“éªŒå·®ï¼ˆ`alert` é˜»å¡é¡µé¢ï¼‰
4. ç»´æŠ¤å›°éš¾ï¼ˆåç«¯é”™è¯¯æ ¼å¼å˜åŒ–éœ€è¦æ”¹ N å¤„ï¼‰

---

### âœ… ä¼˜é›…çš„è§£å†³æ–¹æ¡ˆ

```typescript
// æ‹¦æˆªå™¨ç»Ÿä¸€å¤„ç†é”™è¯¯
try {
  await sendCodeApi(email.value)
  toastStore.success('éªŒè¯ç å·²å‘é€')
} catch (error: any) {
  // âœ… åªå¤„ç†ç‰¹å®šä¸šåŠ¡é”™è¯¯
  if (error.backendError?.code === 'EMAIL_ALREADY_EXISTS') {
    errors.value.email = error.backendError.message
  }
  // å…¶ä»–é”™è¯¯å·²è¢«æ‹¦æˆªå™¨å¤„ç†ï¼ˆè‡ªåŠ¨æ˜¾ç¤º Toastï¼‰
}
```

**ä¼˜ç‚¹**ï¼š
- âœ… ä»£ç ç®€æ´ï¼ˆ90% çš„é”™è¯¯åœ¨æ‹¦æˆªå™¨å¤„ç†ï¼‰
- âœ… ç±»å‹å®‰å…¨ï¼ˆTypeScript æ¨¡å—æ‰©å±•ï¼‰
- âœ… ç”¨æˆ·ä½“éªŒå¥½ï¼ˆToast éé˜»å¡æç¤ºï¼‰
- âœ… æ˜“ç»´æŠ¤ï¼ˆé”™è¯¯æ ¼å¼å˜åŒ–åªéœ€æ”¹æ‹¦æˆªå™¨ï¼‰

---

## é”™è¯¯å¤„ç†çš„ä¸‰å±‚æ¶æ„

### æ¶æ„å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ç¬¬ 1 å±‚ï¼šAxios æ‹¦æˆªå™¨ï¼ˆé€šç”¨é”™è¯¯å¤„ç†ï¼‰    â”‚
â”‚  - 401 è·³è½¬ç™»å½•                          â”‚
â”‚  - ç½‘ç»œé”™è¯¯æç¤º                          â”‚
â”‚  - è‡ªåŠ¨ Toast æç¤º                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â†“ é™„åŠ  error.backendError
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ç¬¬ 2 å±‚ï¼šå·¥å…·å‡½æ•°ï¼ˆå¤‡ç”¨æ–¹æ¡ˆï¼‰            â”‚
â”‚  - getErrorMessage()                    â”‚
â”‚  - ç±»å‹å®ˆå«ï¼ˆç±»å‹å®‰å…¨ï¼‰                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â†“ æä¾›ç±»å‹å®‰å…¨çš„é”™è¯¯æå–
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ç¬¬ 3 å±‚ï¼šä¸šåŠ¡ä»£ç ï¼ˆç‰¹å®šé”™è¯¯å¤„ç†ï¼‰        â”‚
â”‚  - åªå¤„ç†ä¸šåŠ¡ç‰¹æœ‰é€»è¾‘                    â”‚
â”‚  - å¦‚ï¼šé‚®ç®±å·²å­˜åœ¨ â†’ æ˜¾ç¤ºåœ¨è¾“å…¥æ¡†ä¸‹æ–¹     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

### ç¬¬ 1 å±‚ï¼šAxios æ‹¦æˆªå™¨ï¼ˆæ ¸å¿ƒï¼‰

**æ–‡ä»¶ä½ç½®**ï¼š`src/api/index.ts`

```typescript
import axios, { type AxiosError } from 'axios'
import { useToastStore } from '@/stores/toast.store'
import { getToken, removeToken } from '@/utils/token'

const api = axios.create({
  baseURL: import.meta.env.VITE_API_BASE_URL || '/api/v1',
  timeout: 10000,
})

// è¯·æ±‚æ‹¦æˆªå™¨ï¼šè‡ªåŠ¨æ·»åŠ  Token
api.interceptors.request.use(
  (config) => {
    const token = getToken()
    if (token) {
      config.headers.Authorization = `Bearer ${token}`
    }
    return config
  },
  (error) => Promise.reject(error)
)

// å“åº”æ‹¦æˆªå™¨ï¼šç»Ÿä¸€é”™è¯¯å¤„ç† â­â­â­
api.interceptors.response.use(
  (response) => response,
  (error: AxiosError) => {
    const toastStore = useToastStore()
    
    // 1. åç«¯è¿”å›çš„é”™è¯¯
    if (error.response) {
      const data = error.response.data as any
      
      if (data?.error) {
        const { code, message } = data.error
        
        switch (code) {
          // 401 é”™è¯¯ï¼šToken è¿‡æœŸæˆ–æ— æ•ˆ
          case 'UNAUTHORIZED':
          case 'INVALID_CREDENTIALS':
            const isAuthRequest = ['/auth/login', '/auth/register'].some(
              path => error.config?.url?.endsWith(path)
            )
            
            // ä¸æ˜¯ç™»å½•/æ³¨å†Œæ¥å£ â†’ Token è¿‡æœŸ â†’ è·³è½¬ç™»å½•
            if (!isAuthRequest) {
              removeToken()
              toastStore.error('ç™»å½•å·²è¿‡æœŸï¼Œè¯·é‡æ–°ç™»å½•')
              setTimeout(() => {
                window.location.href = '/login'
              }, 1500)
            }
            break
          
          // è¡¨å•é”™è¯¯ï¼šä¸æ˜¾ç¤º Toastï¼ˆç”±ä¸šåŠ¡ä»£ç å¤„ç†ï¼‰
          case 'EMAIL_ALREADY_EXISTS':
          case 'INVALID_VERIFICATION_CODE':
            // ä¸šåŠ¡ä»£ç ä¼šè¯»å– error.backendError æ˜¾ç¤ºåœ¨è¡¨å•ä¸‹æ–¹
            break
          
          // å…¶ä»–é”™è¯¯ï¼šç»Ÿä¸€æ˜¾ç¤º Toast
          default:
            toastStore.error(message)
        }
        
        // â­ å…³é”®ï¼šå°†åç«¯é”™è¯¯é™„åŠ åˆ° error å¯¹è±¡
        error.backendError = data.error
      }
    }
    
    // 2. ç½‘ç»œé”™è¯¯ï¼ˆæ— å“åº”ï¼‰
    else if (error.request) {
      toastStore.error('ç½‘ç»œè¯·æ±‚å¤±è´¥ï¼Œè¯·æ£€æŸ¥ç½‘ç»œ')
    }
    
    // 3. å…¶ä»–é”™è¯¯
    else {
      toastStore.error('è¯·æ±‚å¤±è´¥ï¼Œè¯·ç¨åé‡è¯•')
    }
    
    return Promise.reject(error)
  }
)

// â­ TypeScript æ¨¡å—æ‰©å±•ï¼šç»™ AxiosError æ·»åŠ è‡ªå®šä¹‰å±æ€§
declare module 'axios' {
  export interface AxiosError {
    backendError?: {
      code: string
      message: string
      details?: any
    }
  }
}

export default api
```

**å…³é”®ç‚¹**ï¼š
1. **åˆ†å±‚å¤„ç†**ï¼š401ã€è¡¨å•é”™è¯¯ã€é€šç”¨é”™è¯¯åˆ†åˆ«å¤„ç†
2. **error.backendError**ï¼šå°†åç«¯é”™è¯¯é™„åŠ åˆ° error å¯¹è±¡ï¼Œä¸šåŠ¡ä»£ç å¯é€‰æ‹©æ€§ä½¿ç”¨
3. **TypeScript æ¨¡å—æ‰©å±•**ï¼šè®© `error.backendError` æœ‰ç±»å‹æç¤º

---

### ç¬¬ 2 å±‚ï¼šå·¥å…·å‡½æ•°ï¼ˆå¤‡ç”¨æ–¹æ¡ˆï¼‰

**æ–‡ä»¶ä½ç½®**ï¼š`src/utils/error-handler.ts`

```typescript
import type { AxiosError } from 'axios'

// åç«¯é”™è¯¯å“åº”ç±»å‹
export interface BackendError {
  code: string
  message: string
  details?: Record<string, any>
}

export interface BackendErrorResponse {
  error: BackendError
}

// ç±»å‹å®ˆå«ï¼šåˆ¤æ–­æ˜¯å¦ä¸º AxiosError
export function isAxiosError(error: unknown): error is AxiosError {
  return (error as AxiosError).isAxiosError === true
}

// ç±»å‹å®ˆå«ï¼šåˆ¤æ–­æ˜¯å¦ä¸ºåç«¯é”™è¯¯å“åº”
export function isBackendErrorResponse(data: unknown): data is BackendErrorResponse {
  return (
    typeof data === 'object' &&
    data !== null &&
    'error' in data &&
    typeof (data as any).error === 'object' &&
    'code' in (data as any).error &&
    'message' in (data as any).error
  )
}

// æå–é”™è¯¯ä¿¡æ¯ï¼ˆå®Œå…¨ç±»å‹å®‰å…¨ï¼‰
export function getErrorMessage(error: unknown): string {
  if (!isAxiosError(error)) {
    return 'ç½‘ç»œè¯·æ±‚å¤±è´¥'
  }
  
  const responseData = error.response?.data
  
  if (isBackendErrorResponse(responseData)) {
    return responseData.error.message
  }
  
  // å¤„ç† HTTP çŠ¶æ€ç é”™è¯¯
  if (error.response) {
    const statusMessages: Record<number, string> = {
      400: 'è¯·æ±‚å‚æ•°é”™è¯¯',
      401: 'è¯·å…ˆç™»å½•',
      403: 'æƒé™ä¸è¶³',
      404: 'è¯·æ±‚çš„èµ„æºä¸å­˜åœ¨',
      500: 'æœåŠ¡å™¨å†…éƒ¨é”™è¯¯',
    }
    return statusMessages[error.response.status] || 'è¯·æ±‚å¤±è´¥'
  }
  
  return 'æœªçŸ¥é”™è¯¯'
}

// æå–é”™è¯¯ç 
export function getErrorCode(error: unknown): string | null {
  if (!isAxiosError(error)) return null
  
  const data = error.response?.data as BackendErrorResponse | undefined
  return data?.error?.code || null
}
```

**ä½¿ç”¨åœºæ™¯**ï¼š
- é API è¯·æ±‚çš„é”™è¯¯ï¼ˆå¦‚ WebSocketï¼‰
- éœ€è¦è‡ªå®šä¹‰é”™è¯¯å¤„ç†é€»è¾‘çš„åœºæ™¯
- å•å…ƒæµ‹è¯•

---

### ç¬¬ 3 å±‚ï¼šä¸šåŠ¡ä»£ç ï¼ˆç‰¹å®šé”™è¯¯å¤„ç†ï¼‰

**æ–‡ä»¶ä½ç½®**ï¼š`src/views/RegisterView.vue`

```typescript
const handleSendCode = async () => {
  if (!isValidEmail.value) return
  
  try {
    await sendCodeApi(email.value)
    toastStore.success('éªŒè¯ç å·²å‘é€ï¼Œè¯·æŸ¥æ”¶é‚®ä»¶')
    
    // è®¾ç½®å€’è®¡æ—¶
    countdown.value = 60
    // ...
  } catch (error: any) {
    // âœ… åªå¤„ç†ç‰¹å®šä¸šåŠ¡é”™è¯¯ï¼ˆé‚®ç®±å·²å­˜åœ¨ï¼‰
    if (error.backendError?.code === 'EMAIL_ALREADY_EXISTS') {
      errors.value.email = error.backendError.message
    }
    // å…¶ä»–é”™è¯¯å·²åœ¨æ‹¦æˆªå™¨ä¸­ç”¨ Toast æ˜¾ç¤ºäº†
  }
}

const handleRegister = async () => {
  if (!validateForm()) return
  
  isLoading.value = true
  
  try {
    await authStore.register({
      email: email.value,
      password: password.value,
      verification_code: code.value,
    })
    
    toastStore.success('æ³¨å†ŒæˆåŠŸï¼å³å°†è·³è½¬...')
    
    setTimeout(() => {
      router.push('/')
    }, 1000)
  } catch (error: any) {
    // âœ… æ‹¦æˆªå™¨å·²å¤„ç†ï¼Œè¿™é‡Œç”šè‡³å¯ä»¥ä¸å†™ catch
    // å¦‚æœéœ€è¦ç‰¹æ®Šå¤„ç†ï¼Œå¯ä»¥æ£€æŸ¥ error.backendError.code
  } finally {
    isLoading.value = false
  }
}
```

**å…³é”®ç‚¹**ï¼š
- ä¸šåŠ¡ä»£ç åªå…³æ³¨**ç‰¹å®šé”™è¯¯**ï¼ˆå¦‚é‚®ç®±å·²å­˜åœ¨ï¼‰
- é€šç”¨é”™è¯¯ï¼ˆç½‘ç»œé”™è¯¯ã€500 ç­‰ï¼‰å·²è¢«æ‹¦æˆªå™¨å¤„ç†
- ä»£ç ç®€æ´ï¼Œæ˜“è¯»

---

## TypeScript ç±»å‹å®‰å…¨

### é—®é¢˜ï¼šç¬¬ä¸‰æ–¹åº“çš„ç±»å‹å®šä¹‰ä¸å¤Ÿç”¨æ€ä¹ˆåŠï¼Ÿ

**åœºæ™¯**ï¼šä½ æƒ³ç»™ `AxiosError` æ·»åŠ è‡ªå®šä¹‰å±æ€§ `backendError`ï¼Œä½† axios å®˜æ–¹ç±»å‹å®šä¹‰é‡Œæ²¡æœ‰ã€‚

```typescript
// æ‹¦æˆªå™¨ä¸­èµ‹å€¼
error.backendError = data.error
// âŒ TypeScript æŠ¥é”™ï¼šç±»å‹"AxiosError"ä¸Šä¸å­˜åœ¨å±æ€§"backendError"
```

---

### è§£å†³æ–¹æ¡ˆï¼šæ¨¡å—æ‰©å±•ï¼ˆModule Augmentationï¼‰

```typescript
// å£°æ˜ç±»å‹æ‰©å±•
declare module 'axios' {
  export interface AxiosError {
    backendError?: {
      code: string
      message: string
      details?: any
    }
  }
}
```

**æ•ˆæœ**ï¼š

```typescript
// æ‹¦æˆªå™¨èµ‹å€¼
error.backendError = data.error  // âœ… TypeScript é€šè¿‡

// ä¸šåŠ¡ä»£ç ä½¿ç”¨
catch (error: any) {
  if (error.backendError?.code === 'EMAIL_ALREADY_EXISTS') {
    //           ^^^^^^^^^^^  âœ… æœ‰æ™ºèƒ½æç¤ºï¼
    errors.value.email = error.backendError.message
  }
}
```

---

### åŸç†ï¼šæ¥å£åˆå¹¶ï¼ˆDeclaration Mergingï¼‰

TypeScript å…è®¸å¯¹**åŒåæ¥å£**è¿›è¡Œåˆå¹¶ï¼š

```typescript
// axios åº“åŸæœ¬å®šä¹‰
export interface AxiosError {
  message: string
  response?: AxiosResponse
  // ...
}

// ä½ çš„æ‰©å±•ï¼ˆä¼šè‡ªåŠ¨åˆå¹¶ï¼‰
declare module 'axios' {
  export interface AxiosError {
    backendError?: { ... }
  }
}

// æœ€ç»ˆç»“æœï¼šAxiosError åŒæ—¶æ‹¥æœ‰åŸæœ¬çš„å±æ€§ + ä½ æ–°å¢çš„å±æ€§
```

**ä¼˜ç‚¹**ï¼š
- âœ… ä¸ä¿®æ”¹ `node_modules`ï¼ˆnpm install ä¸ä¼šè¦†ç›–ï¼‰
- âœ… åªåœ¨ä½ çš„é¡¹ç›®ç”Ÿæ•ˆï¼ˆä¸å½±å“å…¶ä»–é¡¹ç›®ï¼‰
- âœ… ç±»å‹å®‰å…¨æœ‰ä¿éšœï¼ˆæœ‰æ™ºèƒ½æç¤ºï¼‰

---

## å®æˆ˜ï¼šæœ¬é¡¹ç›®çš„é”™è¯¯å¤„ç†æ–¹æ¡ˆ

### åç«¯é”™è¯¯å“åº”æ ¼å¼

```json
{
  "error": {
    "code": "EMAIL_ALREADY_EXISTS",
    "message": "é‚®ç®±å·²è¢«æ³¨å†Œ",
    "details": {
      "field": "email",
      "value": "test@example.com"
    }
  }
}
```

---

### å‰ç«¯é”™è¯¯å¤„ç†æµç¨‹å›¾

```
ç”¨æˆ·æ“ä½œï¼ˆå¦‚ç‚¹å‡»æ³¨å†Œï¼‰
        â†“
    å‘é€ API è¯·æ±‚
        â†“
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ è¯·æ±‚æˆåŠŸï¼Ÿ       â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚ No
           â†“
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ Axios å“åº”æ‹¦æˆªå™¨                â”‚
    â”‚ 1. åˆ¤æ–­é”™è¯¯ç±»å‹                 â”‚
    â”‚    - 401 â†’ è·³è½¬ç™»å½•             â”‚
    â”‚    - è¡¨å•é”™è¯¯ â†’ ä¸æ˜¾ç¤º Toast    â”‚
    â”‚    - å…¶ä»– â†’ Toast æç¤º          â”‚
    â”‚ 2. é™„åŠ  error.backendError      â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â†“
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ ä¸šåŠ¡ä»£ç  catch å—               â”‚
    â”‚ 1. æ£€æŸ¥ error.backendError.code â”‚
    â”‚ 2. å¤„ç†ç‰¹å®šä¸šåŠ¡é”™è¯¯             â”‚
    â”‚    å¦‚ï¼šé‚®ç®±å·²å­˜åœ¨ â†’ è¡¨å•æç¤º    â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â†“
    ç”¨æˆ·çœ‹åˆ°é”™è¯¯æç¤ºï¼ˆToast æˆ–è¡¨å•é”™è¯¯ï¼‰
```

---

### é”™è¯¯ç±»å‹åˆ†ç±»å¤„ç†

| é”™è¯¯ç±»å‹ | é”™è¯¯ç ç¤ºä¾‹ | å¤„ç†æ–¹å¼ | ç”¨æˆ·ä½“éªŒ |
|---------|----------|---------|---------|
| **è®¤è¯é”™è¯¯** | `UNAUTHORIZED` | æ‹¦æˆªå™¨ï¼šæ¸…é™¤ Token + è·³è½¬ç™»å½• | Toast + è‡ªåŠ¨è·³è½¬ |
| **è¡¨å•é”™è¯¯** | `EMAIL_ALREADY_EXISTS` | ä¸šåŠ¡ä»£ç ï¼šæ˜¾ç¤ºåœ¨è¾“å…¥æ¡†ä¸‹æ–¹ | è¡¨å•é”™è¯¯æç¤º |
| **é€šç”¨é”™è¯¯** | `INTERNAL_SERVER_ERROR` | æ‹¦æˆªå™¨ï¼šToast æç¤º | Toast æç¤º |
| **ç½‘ç»œé”™è¯¯** | æ— å“åº” | æ‹¦æˆªå™¨ï¼šToast æç¤º | Toast æç¤º |

---

## å¸¸è§è¯¯åŒºä¸æœ€ä½³å®è·µ

### âŒ è¯¯åŒº 1ï¼šæ‰€æœ‰é”™è¯¯éƒ½ç”¨ alert()

```typescript
catch (error) {
  alert('æ“ä½œå¤±è´¥')  // âŒ é˜»å¡é¡µé¢ï¼Œç”¨æˆ·ä½“éªŒå·®
}
```

**âœ… æ­£ç¡®åšæ³•**ï¼šä½¿ç”¨ Toast ç»„ä»¶ï¼ˆéé˜»å¡ï¼‰

```typescript
catch (error) {
  toastStore.error('æ“ä½œå¤±è´¥')  // âœ… ä¸é˜»å¡é¡µé¢
}
```

---

### âŒ è¯¯åŒº 2ï¼šerror ç±»å‹ç”¨ any

```typescript
catch (error: any) {  // âŒ å¤±å»ç±»å‹å®‰å…¨
  error.response.data.error.message  // æ— æ™ºèƒ½æç¤º
}
```

**âœ… æ­£ç¡®åšæ³•**ï¼šä½¿ç”¨ç±»å‹å®ˆå«æˆ–æ¨¡å—æ‰©å±•

```typescript
catch (error: any) {  // å¯ä»¥ç”¨ anyï¼Œä½†è®¿é—®æ—¶æœ‰ç±»å‹æç¤º
  if (error.backendError?.code === 'EMAIL_ALREADY_EXISTS') {
    //           ^^^^^^^^^^^  âœ… æœ‰æ™ºèƒ½æç¤ºï¼
  }
}
```

---

### âŒ è¯¯åŒº 3ï¼šæ‹¦æˆªå™¨ä¸­å¤„ç†æ‰€æœ‰é”™è¯¯

```typescript
// æ‹¦æˆªå™¨ä¸­
if (data?.error) {
  toastStore.error(data.error.message)  // âŒ åŒ…æ‹¬è¡¨å•é”™è¯¯ä¹Ÿæ˜¾ç¤º Toast
}
```

**é—®é¢˜**ï¼šé‚®ç®±å·²å­˜åœ¨çš„é”™è¯¯åº”è¯¥æ˜¾ç¤ºåœ¨è¾“å…¥æ¡†ä¸‹æ–¹ï¼Œè€Œä¸æ˜¯ Toastã€‚

**âœ… æ­£ç¡®åšæ³•**ï¼šåˆ†å±‚å¤„ç†

```typescript
// æ‹¦æˆªå™¨ä¸­
switch (code) {
  case 'EMAIL_ALREADY_EXISTS':
    // ä¸æ˜¾ç¤º Toastï¼Œç”±ä¸šåŠ¡ä»£ç å¤„ç†
    break
  default:
    toastStore.error(message)  // å…¶ä»–é”™è¯¯æ‰æ˜¾ç¤º Toast
}
```

---

### âŒ è¯¯åŒº 4ï¼šé‡å¤çš„é”™è¯¯å¤„ç†ä»£ç 

```typescript
// æ–‡ä»¶ A
catch (error) {
  if (error.response?.data?.error?.message) {
    return error.response.data.error.message
  }
}

// æ–‡ä»¶ B
catch (error) {
  if (error.response?.data?.error?.message) {  // âŒ é‡å¤ä»£ç 
    return error.response.data.error.message
  }
}
```

**âœ… æ­£ç¡®åšæ³•**ï¼šå°è£…å·¥å…·å‡½æ•°æˆ–ä½¿ç”¨æ‹¦æˆªå™¨

```typescript
// æ–¹æ¡ˆ 1ï¼šæ‹¦æˆªå™¨ + error.backendError
catch (error: any) {
  return error.backendError?.message || 'æœªçŸ¥é”™è¯¯'
}

// æ–¹æ¡ˆ 2ï¼šå·¥å…·å‡½æ•°
catch (error) {
  return getErrorMessage(error)
}
```

---

## è¿›é˜¶ï¼šç±»å‹å®ˆå«è¯¦è§£

### ä»€ä¹ˆæ˜¯ç±»å‹å®ˆå«ï¼Ÿ

**ç±»å‹å®ˆå«ï¼ˆType Guardï¼‰** æ˜¯ TypeScript çš„ä¸€ç§æŠ€æœ¯ï¼Œç”¨äºåœ¨**è¿è¡Œæ—¶æ£€æŸ¥ç±»å‹**ï¼Œå¹¶å‘Šè¯‰ TypeScript ç¼–è¯‘å™¨ç±»å‹ä¿¡æ¯ã€‚

---

### æ ¸å¿ƒè¯­æ³•ï¼š`value is Type` æ·±åº¦è§£æ

#### å®Œæ•´è¯­æ³•ç¤ºä¾‹

```typescript
function isAxiosError(error: unknown): error is AxiosError {
  //                   ^^^^^^^^^^^^^^   ^^^^^^^^^^^^^^^^^^^
  //                   å‚æ•°ç±»å‹          è¿”å›ç±»å‹è°“è¯ï¼ˆç‰¹æ®Šè¯­æ³•ï¼‰
  
  return (error as AxiosError).isAxiosError === true
  //     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  //     è¿™ä¸ªè¡¨è¾¾å¼çš„ç»“æœæ˜¯ true æˆ– falseï¼ˆæ™®é€šå¸ƒå°”å€¼ï¼‰
}
```

---

### ğŸ¯ æ·±å…¥ç†è§£ï¼š`error is AxiosError` çš„åŒé‡æ€§è´¨

#### æ€§è´¨ 1ï¼šè¿è¡Œæ—¶ï¼ˆJavaScript å±‚é¢ï¼‰

**æœ¬è´¨**ï¼šè¿™ä¸ªå‡½æ•°è¿”å›çš„å°±æ˜¯æ™®é€šçš„ `boolean` å€¼ï¼ˆ`true` æˆ– `false`ï¼‰

```typescript
const result = isAxiosError(someError)
console.log(result)  // è¾“å‡ºï¼štrue æˆ– false
console.log(typeof result)  // è¾“å‡ºï¼š'boolean'
```

**å…³é”®ç‚¹**ï¼š
- âœ… è¿”å› `true` â†’ è¡¨ç¤º error æ˜¯ AxiosError
- âœ… è¿”å› `false` â†’ è¡¨ç¤º error ä¸æ˜¯ AxiosError
- âœ… å‡½æ•°è¿”å›å€¼æ°¸è¿œæ˜¯ `boolean` ç±»å‹

#### æ€§è´¨ 2ï¼šç¼–è¯‘æ—¶ï¼ˆTypeScript å±‚é¢ï¼‰

**æœ¬è´¨**ï¼šè¿™æ˜¯ç»™ TypeScript ç¼–è¯‘å™¨çš„"ç±»å‹æç¤º"

```typescript
if (isAxiosError(error)) {
  // âœ… è¿”å› true æ—¶ï¼ŒTypeScript çŸ¥é“ï¼šerror æ˜¯ AxiosError
  console.log(error.message)  // æœ‰æ™ºèƒ½æç¤º
} else {
  // âœ… è¿”å› false æ—¶ï¼ŒTypeScript çŸ¥é“ï¼šerror ä¸æ˜¯ AxiosError
  console.log('ä¸æ˜¯ AxiosError')
}
```

---

### ğŸ§ª å®æˆ˜æµ‹è¯•ï¼šéªŒè¯è¿”å›å€¼

```typescript
function isAxiosError(error: unknown): error is AxiosError {
  return (error as AxiosError).isAxiosError === true
}

// ========== æµ‹è¯• 1ï¼šæ˜¯ AxiosError ==========
const error1 = { isAxiosError: true, message: 'Network Error' }
const result1 = isAxiosError(error1)

console.log('è¿”å›å€¼:', result1)           // è¾“å‡ºï¼štrue
console.log('è¿”å›å€¼ç±»å‹:', typeof result1) // è¾“å‡ºï¼š'boolean'

// ========== æµ‹è¯• 2ï¼šä¸æ˜¯ AxiosError ==========
const error2 = new Error('Regular error')
const result2 = isAxiosError(error2)

console.log('è¿”å›å€¼:', result2)           // è¾“å‡ºï¼šfalse
console.log('è¿”å›å€¼ç±»å‹:', typeof result2) // è¾“å‡ºï¼š'boolean'

// ========== æµ‹è¯• 3ï¼šå„ç§è¾¹ç•Œæƒ…å†µ ==========
console.log(isAxiosError(null))       // è¾“å‡ºï¼šfalse
console.log(isAxiosError(undefined))  // è¾“å‡ºï¼šfalse
console.log(isAxiosError('error'))    // è¾“å‡ºï¼šfalse
console.log(isAxiosError(123))        // è¾“å‡ºï¼šfalse
```

**ç»“è®º**ï¼šæ— è®ºä»€ä¹ˆæƒ…å†µï¼Œå‡½æ•°è¿”å›çš„éƒ½æ˜¯ `boolean` å€¼ã€‚

---

### ğŸ“Š ç±»å‹è°“è¯ vs æ™®é€š boolean å¯¹æ¯”

#### æ–¹å¼ 1ï¼šæ™®é€š boolean è¿”å›ç±»å‹ï¼ˆâŒ ä¸æ¨èï¼‰

```typescript
function checkIsAxiosError(error: unknown): boolean {
  //                                       ^^^^^^^
  //                                       æ™®é€š boolean
  return (error as AxiosError).isAxiosError === true
}

// ä½¿ç”¨æ—¶
if (checkIsAxiosError(error)) {
  // âŒ TypeScript ä¸çŸ¥é“ error çš„ç±»å‹
  console.log(error.message)
  // âŒ æŠ¥é”™ï¼šå¯¹è±¡çš„ç±»å‹ä¸º "unknown"
  
  // éœ€è¦æ‰‹åŠ¨ç±»å‹æ–­è¨€
  console.log((error as AxiosError).message)
}
```

#### æ–¹å¼ 2ï¼šç±»å‹è°“è¯è¿”å›ç±»å‹ï¼ˆâœ… æ¨èï¼‰

```typescript
function isAxiosError(error: unknown): error is AxiosError {
  //                                    ^^^^^^^^^^^^^^^^^^^
  //                                    ç±»å‹è°“è¯
  return (error as AxiosError).isAxiosError === true
}

// ä½¿ç”¨æ—¶
if (isAxiosError(error)) {
  // âœ… TypeScript è‡ªåŠ¨çŸ¥é“ error æ˜¯ AxiosError
  console.log(error.message)  // âœ… æœ‰æ™ºèƒ½æç¤ºï¼Œæ— éœ€æ‰‹åŠ¨æ–­è¨€
}
```

#### å¯¹æ¯”æ€»ç»“

| ç‰¹æ€§ | æ™®é€š boolean | ç±»å‹è°“è¯ |
|-----|-------------|---------|
| è¿”å›å€¼ï¼ˆè¿è¡Œæ—¶ï¼‰ | `true` æˆ– `false` | `true` æˆ– `false` |
| ç±»å‹æ”¶çª„ï¼ˆç¼–è¯‘æ—¶ï¼‰ | âŒ æ—  | âœ… æœ‰ |
| æ™ºèƒ½æç¤º | âŒ æ—  | âœ… æœ‰ |
| ç±»å‹å®‰å…¨ | âš ï¸ éœ€æ‰‹åŠ¨æ–­è¨€ | âœ… è‡ªåŠ¨æ”¶çª„ |

---

### ğŸ” TypeScript ç±»å‹æ”¶çª„ï¼ˆType Narrowingï¼‰è¯¦è§£

#### è¿”å› true æ—¶çš„ç±»å‹æ”¶çª„

```typescript
function handleError(error: unknown) {
  // æ­¤æ—¶ error çš„ç±»å‹æ˜¯ unknown
  console.log(error.message)  // âŒ æŠ¥é”™ï¼šunknown ç±»å‹æ— æ³•è®¿é—®å±æ€§
  
  if (isAxiosError(error)) {
    // âœ… TypeScript å†…éƒ¨é€»è¾‘ï¼š
    // "isAxiosError è¿”å› true â†’ error çš„ç±»å‹ä» unknown æ”¶çª„ä¸º AxiosError"
    
    console.log(error.message)        // âœ… å¯ä»¥è®¿é—®
    console.log(error.response)       // âœ… å¯ä»¥è®¿é—®
    console.log(error.isAxiosError)   // âœ… å¯ä»¥è®¿é—®
    
    // æ­¤æ—¶ error çš„ç±»å‹æ˜¯ AxiosError
  }
}
```

#### è¿”å› false æ—¶çš„ç±»å‹å¤„ç†

```typescript
function handleError(error: unknown) {
  if (isAxiosError(error)) {
    // è¿”å› true æ—¶çš„ä»£ç 
    console.log('æ˜¯ AxiosError:', error.message)
  } else {
    // âœ… è¿”å› false æ—¶ï¼ŒTypeScript çŸ¥é“ error ä¸æ˜¯ AxiosError
    // ä½† error çš„ç±»å‹ä»ç„¶æ˜¯ unknownï¼ˆæˆ–è€…æ’é™¤äº† AxiosErrorï¼‰
    
    console.log(error.message)  // âŒ æŠ¥é”™ï¼šunknown ç±»å‹
    
    // éœ€è¦è¿›ä¸€æ­¥æ£€æŸ¥
    if (error instanceof Error) {
      console.log('æ˜¯æ™®é€š Error:', error.message)  // âœ… ç°åœ¨å¯ä»¥è®¿é—®äº†
    } else {
      console.log('æœªçŸ¥ç±»å‹é”™è¯¯')
    }
  }
}
```

---

### ğŸ¨ ç±»æ¯”ï¼šäº¤é€šä¿¡å·ç¯

å¯ä»¥æŠŠç±»å‹å®ˆå«æƒ³è±¡æˆ**äº¤é€šä¿¡å·ç¯**ï¼š

```typescript
function isAxiosError(error: unknown): error is AxiosError {
  // è¿è¡Œæ—¶ï¼šæ£€æŸ¥ error æ˜¯å¦æ»¡è¶³æ¡ä»¶
  // å°±åƒæ£€æŸ¥è½¦è¾†æ˜¯å¦æ»¡è¶³é€šè¡Œæ¡ä»¶
  
  if (ç¬¦åˆ AxiosError çš„ç‰¹å¾) {
    return true  // ğŸŸ¢ ç»¿ç¯ï¼šå‘Šè¯‰ TypeScript "è¿™æ˜¯ AxiosErrorï¼Œå¯ä»¥å®‰å…¨é€šè¡Œ"
  } else {
    return false // ğŸ”´ çº¢ç¯ï¼šå‘Šè¯‰ TypeScript "è¿™ä¸æ˜¯ AxiosErrorï¼Œä¸èƒ½é€šè¡Œ"
  }
}
```

**ä½¿ç”¨æ—¶**ï¼š

```typescript
if (isAxiosError(error)) {
  // ğŸŸ¢ ç»¿ç¯ï¼šTypeScript å…è®¸ä½ è®¿é—® AxiosError çš„å±æ€§
  error.message        // âœ… å®‰å…¨é€šè¡Œ
  error.response       // âœ… å®‰å…¨é€šè¡Œ
} else {
  // ğŸ”´ çº¢ç¯ï¼šTypeScript ä¸å…è®¸ä½ è®¿é—® AxiosError çš„å±æ€§
  error.message        // âŒ ç¦æ­¢é€šè¡Œï¼ˆä¼šæŠ¥é”™ï¼‰
}
```

---

### ğŸ“ æ ¸å¿ƒåŸç†æ€»ç»“

#### ç±»å‹å®ˆå«çš„æœ¬è´¨

```typescript
function isType(value: unknown): value is SomeType {
  //                              ^^^^^^^^^^^^^^^^^
  //                              è¿™ä¸æ˜¯çœŸæ­£çš„è¿”å›ç±»å‹ï¼
  //                              è€Œæ˜¯ç»™ TypeScript çš„"æç¤º"
  
  return /* è¿è¡Œæ—¶æ£€æŸ¥é€»è¾‘ */  // å®é™…è¿”å› true æˆ– false
}
```

#### å·¥ä½œæµç¨‹

```
1. è¿è¡Œæ—¶ï¼ˆJavaScriptï¼‰ï¼š
   å‡½æ•°æ‰§è¡Œæ£€æŸ¥é€»è¾‘ â†’ è¿”å› true æˆ– false
   
2. ç¼–è¯‘æ—¶ï¼ˆTypeScriptï¼‰ï¼š
   - è¿”å› true  â†’ å°†ç±»å‹æ”¶çª„ä¸º SomeType
   - è¿”å› false â†’ çŸ¥é“ä¸æ˜¯ SomeTypeï¼ˆä½†ä»æ˜¯ unknownï¼‰
```

---

### å®æˆ˜å¯¹æ¯”ï¼šæœ‰æ— ç±»å‹å®ˆå«çš„åŒºåˆ«

#### âŒ æ²¡æœ‰ç±»å‹å®ˆå«

```typescript
function handleError(error: unknown) {
  // ç›´æ¥è®¿é—®å±æ€§ä¼šæŠ¥é”™
  console.log(error.message)
  // âŒ TypeScript é”™è¯¯ï¼šå¯¹è±¡çš„ç±»å‹ä¸º "unknown"
  
  // åªèƒ½ç”¨ç±»å‹æ–­è¨€ï¼ˆä¸å®‰å…¨ï¼‰
  console.log((error as AxiosError).message)
  // âš ï¸ èƒ½è¿è¡Œï¼Œä½†å¦‚æœ error ä¸æ˜¯ AxiosErrorï¼Œä¼šå´©æºƒ
}
```

#### âœ… æœ‰ç±»å‹å®ˆå«

```typescript
function handleError(error: unknown) {
  if (isAxiosError(error)) {
    // âœ… TypeScript çŸ¥é“è¿™é‡Œ error æ˜¯ AxiosError
    console.log(error.message)        // âœ… æœ‰æ™ºèƒ½æç¤º
    console.log(error.response?.data) // âœ… æœ‰æ™ºèƒ½æç¤º
    console.log(error.isAxiosError)   // âœ… æœ‰æ™ºèƒ½æç¤º
  } else {
    console.log('ä¸æ˜¯ Axios é”™è¯¯')
  }
}
```

---

### å¤æ‚ç±»å‹å®ˆå«ï¼šæ£€æŸ¥å¯¹è±¡ç»“æ„

```typescript
// åç«¯é”™è¯¯å“åº”æ ¼å¼
interface BackendErrorResponse {
  error: {
    code: string
    message: string
    details?: any
  }
}

// ç±»å‹å®ˆå«ï¼šé€æ­¥æ£€æŸ¥å¯¹è±¡ç»“æ„
export function isBackendErrorResponse(data: unknown): data is BackendErrorResponse {
  return (
    typeof data === 'object' &&        // 1. æ˜¯å¯¹è±¡å—ï¼Ÿ
    data !== null &&                   // 2. ä¸æ˜¯ null å—ï¼Ÿ
    'error' in data &&                 // 3. æœ‰ error å±æ€§å—ï¼Ÿ
    typeof (data as any).error === 'object' &&  // 4. error æ˜¯å¯¹è±¡å—ï¼Ÿ
    'code' in (data as any).error &&   // 5. error æœ‰ code å—ï¼Ÿ
    'message' in (data as any).error   // 6. error æœ‰ message å—ï¼Ÿ
  )
}
```

**ä¸ºä»€ä¹ˆè¦æ£€æŸ¥è¿™ä¹ˆå¤šï¼Ÿ** ç¡®ä¿è¿è¡Œæ—¶æ•°æ®ç¬¦åˆé¢„æœŸæ ¼å¼ã€‚

---

### ç±»å‹å®ˆå« vs ç±»å‹æ–­è¨€

| å¯¹æ¯”é¡¹ | ç±»å‹å®ˆå« | ç±»å‹æ–­è¨€ |
|-------|---------|---------|
| è¯­æ³• | `error is AxiosError` | `error as AxiosError` |
| è¿è¡Œæ—¶æ£€æŸ¥ | âœ… æœ‰æ£€æŸ¥ | âŒ æ— æ£€æŸ¥ï¼ˆå¼ºåˆ¶è½¬æ¢ï¼‰ |
| ç±»å‹å®‰å…¨ | âœ… å®‰å…¨ | âš ï¸ ä¸å®‰å…¨ |
| TypeScript æç¤º | âœ… è‡ªåŠ¨æ”¶çª„ | âš ï¸ éœ€è¦æ‰‹åŠ¨æ–­è¨€ |

**ç¤ºä¾‹å¯¹æ¯”**ï¼š

```typescript
// ========== ç±»å‹æ–­è¨€ï¼ˆä¸å®‰å…¨ï¼‰ ==========
const error: unknown = { foo: 'bar' }

const axiosError = error as AxiosError  // âš ï¸ å¼ºåˆ¶è½¬æ¢ï¼Œä¸æ£€æŸ¥
console.log(axiosError.message)         // ğŸ’¥ è¿è¡Œæ—¶å´©æºƒï¼

// ========== ç±»å‹å®ˆå«ï¼ˆå®‰å…¨ï¼‰ ==========
if (isAxiosError(error)) {  // âœ… è¿è¡Œæ—¶æ£€æŸ¥
  console.log(error.message)  // âœ… å®‰å…¨
} else {
  console.log('ä¸æ˜¯ AxiosError')
}
```

---

## æ€»ç»“

### é”™è¯¯å¤„ç†çš„æ ¸å¿ƒåŸåˆ™

1. **åˆ†å±‚å¤„ç†**ï¼šæ‹¦æˆªå™¨å¤„ç†é€šç”¨é”™è¯¯ï¼Œä¸šåŠ¡ä»£ç å¤„ç†ç‰¹å®šé”™è¯¯
2. **DRY åŸåˆ™**ï¼šé¿å…é‡å¤ä»£ç ï¼Œå°è£…å·¥å…·å‡½æ•°
3. **ç±»å‹å®‰å…¨**ï¼šä½¿ç”¨ TypeScript ç±»å‹å®ˆå«å’Œæ¨¡å—æ‰©å±•
4. **ç”¨æˆ·ä½“éªŒ**ï¼šToast éé˜»å¡æç¤º > alert é˜»å¡æç¤º
5. **æ˜“ç»´æŠ¤**ï¼šé”™è¯¯æ ¼å¼å˜åŒ–åªéœ€æ”¹ä¸€å¤„

---

### æœ¬é¡¹ç›®é”™è¯¯å¤„ç†æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Axios æ‹¦æˆªå™¨ï¼ˆapi/index.tsï¼‰            â”‚
â”‚  - 401 â†’ è·³è½¬ç™»å½•                       â”‚
â”‚  - ç½‘ç»œé”™è¯¯ â†’ Toast                     â”‚
â”‚  - é™„åŠ  error.backendError              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  å·¥å…·å‡½æ•°ï¼ˆutils/error-handler.tsï¼‰     â”‚
â”‚  - getErrorMessage()                    â”‚
â”‚  - ç±»å‹å®ˆå«ï¼ˆå¤‡ç”¨æ–¹æ¡ˆï¼‰                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ä¸šåŠ¡ä»£ç ï¼ˆ*.vueï¼‰                       â”‚
â”‚  - åªå¤„ç†ç‰¹å®šä¸šåŠ¡é”™è¯¯                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

### å¿«é€Ÿå‚è€ƒ

**æ‹¦æˆªå™¨**ï¼š`src/api/index.ts`  
**å·¥å…·å‡½æ•°**ï¼š`src/utils/error-handler.ts`  
**ä½¿ç”¨ç¤ºä¾‹**ï¼š`src/views/RegisterView.vue`

---

### å»¶ä¼¸é˜…è¯»

- [TypeScript ç±»å‹å®ˆå«å®˜æ–¹æ–‡æ¡£](https://www.typescriptlang.org/docs/handbook/2/narrowing.html#using-type-predicates)
- [Axios æ‹¦æˆªå™¨æ–‡æ¡£](https://axios-http.com/docs/interceptors)
- [TypeScript æ¨¡å—æ‰©å±•](https://www.typescriptlang.org/docs/handbook/declaration-merging.html#module-augmentation)

---

**æœ€åæ›´æ–°**ï¼š2025-12-20  
**ä½œè€…**ï¼šfastapi_blog å¼€å‘å›¢é˜Ÿ
